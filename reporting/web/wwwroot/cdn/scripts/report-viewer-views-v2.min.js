var SettingsScopes={All:0,SiteSettings:1,ReportSettings:2,EmbedSettings:3,Connector:4,Email:5,Accounts:6,UserDirectorySettings:7,AuthenticationSettings:8,NotificationSettings:9,ManageLicense:10,SupportSettings:11,Subscription:12,Payments:13,CORSPolicySettings:14,Security:15},PermissionEntities={None:0,AllReports:1,ReportsInCategory:2,SpecificReports:3,AllCategories:4,SpecificCategory:5,AllDataSources:6,SpecificDataSource:7,AllFiles:8,SpecificFile:9,AllSchedules:10,SpecificSchedule:11,AllDashboards:12,DashboardsInCategory:13,SpecificDashboard:14,AllWidgets:15,SpecificWidget:16,AllDatasets:17,SpecificDataset:18,SpecificItemView:19,AllItemViews:20,SpecificSlideshow:21,AllSlideshow:22,SpecificSettings:23,AllSettings:24,SpecificGroup:25,UsersandGroups:26,SpecificPermissions:27,AllPermissions:28,AllGroups:29},ReportLayoutView={Card:1,Grid:2};function ajaxPostCall(e,t,a,n,i,o,r){if(embedConfig.IsEmbedCode){if("GET"==e){var s=jQuery.param(a);t.api=t.api+"?"+s,a=null}return $.ajax({type:e,url:reportServerApiUrlForServerEmbed+t.api,headers:{"Content-type":"application/json",Authorization:token},data:JSON.stringify(a),beforeSend:function(e){isNullOrWhitespace(n)||n(e)},success:function(e,t){isNullOrWhitespace(i)||i(e)},error:function(e){isNullOrWhitespace(o)||o()},complete:function(e){isNullOrWhitespace(r)||r(e)}})}return $.ajax({type:e,url:t.web,data:a,beforeSend:function(e){embedConfig.IsEmbedReport||e.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie()),isNullOrWhitespace(n)||n(e)},success:function(e,t){isNullOrWhitespace(i)||i(e)},error:function(e){isNullOrWhitespace(o)||o()},complete:function(e){isNullOrWhitespace(r)||r(e)}})}function isNullOrWhitespace(e){return null==e||null==e||""==$.trim(e)}function generateProfileAvatar(){$(".profile-pic-tag").each(function(){var e=$(this).attr("data-id"),t=$(this).attr("data-image-size"),a=t/3,n=$(this).attr("data-display-name"),i=$(this).attr("data-type");if($(this).html(""),0!=e){var o=["#b7fbff","#a9eec2","#ffe0a3","#ffa1ac","#8ed6ff","#bf9fee","#ffa0d2","#32dbc6","#d2c8c8","#e3e7f1"];if("user"==i){var r=e.match(/(\d+)/g),s=0;for(s=0;s<r.length;s++)var l=r[0][0];$(this).css("background-color",o[l]);var c=idpUrl+"/User/Avatar?id="+e,p=$('<img id="default-profile-image">');p.attr("src",c),p.attr("width",t),p.attr("height",t),p.css("position","absolute"),p.css("top","0px"),p.css("left","0px"),p.css("border-radius","50%"),p.appendTo($(this))}else{var d=e%10;$(this).css("background-color",o[d])}$(this).css("width",t),$(this).css("height",t),$(this).css("line-height",t+"px");var u=n.trim().toUpperCase().split(/ /),h=$('<span id="first-letter">');null==u[1]?h.text(u[0][0]):h.text(u[0][0]+u[u.length-1][0]),h.css("font-size",a+"px"),h.css("margin-left","2px"),h.appendTo($(this))}})}function extractXSRFTokenFromCookie(){var e=document.cookie.split("; ").find(e=>e.startsWith("XSRF-TOKEN="));return e?e.split("=")[1]:null}function fnOnUserGridActionBegin(e){isFirstRequest=!0;var t=$("#userSearchKey").val();this.model.query._params.push({key:"searchKey",value:t});var a,n=[],i=createLoader("UserGrid");if(this.element.ejWaitingPopup({template:$("#"+i)}),e.model.filterSettings.filteredColumns.length>0){for(a=0;a<e.model.filterSettings.filteredColumns.length;a++){var o=e.model.filterSettings.filteredColumns[a];n.push({PropertyName:o.field,FilterType:o.operator,FilterKey:o.value})}this.model.query._params.push({key:"filterCollection",value:n})}}function createLoader(e,t){var a="";if("string"==typeof e){t=0===e.indexOf(".")?".":"#";if(a=(e=0===e.indexOf(".")||0===e.indexOf("#")?e.slice(1,e.length):e)+"-loader-icon",0==$("#"+a).length&&0!=$(t+e).length){var n=$("<div class='loader-blue loader-icon' id='"+a+"'><svg class='circular'><circle class='path' cx='27' cy='27' r='20' fill='none' stroke-width='4' stroke-miterlimit='10'></circle></svg></div>");$("body").append(n)}return a}t=0===(e=t).indexOf(".")?".":"#";if(a=(e=e.slice(1,e.length))+"-loader-icon",0==$("#"+a).length&&0!=$("#"+e).length){n=$("<div class='loader-blue loader-icon' id='"+a+"'><svg class='circular'><circle class='path' cx='27' cy='27' r='20' fill='none' stroke-width='4' stroke-miterlimit='10'></circle></svg></div>");$("body").append(n)}return a}function fnOnGroupGridActionBegin(e){isFirstRequest=!0;var t=$("#groupSearchKey").val();this.model.query._params.push({key:"searchKey",value:t});var a,n=[],i=createLoader("GroupGrid");if(this.element.ejWaitingPopup({template:$("#"+i)}),e.model.filterSettings.filteredColumns.length>0){for(a=0;a<e.model.filterSettings.filteredColumns.length;a++){var o=e.model.filterSettings.filteredColumns[a];n.push({PropertyName:o.field,FilterType:o.operator,FilterKey:o.value})}this.model.query._params.push({key:"filterCollection",value:n})}}function onPermissionDeleteDialogClose(){$("#permission_delete_confirmation").ejDialog("close")}function onPermissionDeleteDialogOpen(){$("#permission_delete_confirmation").ejDialog("open"),$("#permission_delete_confirmation").focus()}function OpenDeleteDialog(e){$("#permission_delete_confirmation").ejDialog("open");var t=$(e).attr("data-itemviewid"),a=$(e).attr("data-item"),n=$(e).attr("data-id");$("#deletedItem").html(a),$("#delete_item_type").val(a),$("#delete_permission_id").val(t),$("#hiddendata-id").val(n)}function DeletePermission(){var e=$("#delete_permission_id").val(),t=$("#delete_item_type").val(),a=$("#hiddendata-id").val();$.ajax({type:"POST",url:DeleteItemViewPermissionUrl,data:{permission:e,deleteItem:t},beforeSend:function(){$("#permission_delete_confirmation_wrapper").ejWaitingPopup("show")},success:function(e){$("#permission_delete_confirmation_wrapper").ejWaitingPopup("hide"),onPermissionDeleteDialogClose(),messageBox("su-delete",window.Server.App.LocalizationContent.RemoveAccess,window.Server.App.LocalizationContent.RemoveAccessSuccess,"success",function(){"group"==t.toLowerCase()?($("#GroupSearch option[value='"+a+"']").attr("selected",!1),$("#GroupSearch").selectpicker("destroy"),$("#GroupSearch").selectpicker()):($("#UserSearch option[value='"+a+"']").attr("selected",!1),$("#UserSearch").selectpicker("destroy"),$("#UserSearch").selectpicker()),refreshUserGroupList();var e=$("#UserGrid").data("ejGrid"),n=$("#GroupGrid").data("ejGrid"),i=$(".ListItems.selected").attr("data-grid");e.refreshContent(),n.refreshContent(),"usergrid"==i.toLowerCase()?$("#GroupGrid_WaitingPopup").hide():$("#UserGrid_WaitingPopup").hide(),onCloseMessageBox()})}})}function InitializeShareView(){$("#UserSearch").selectpicker("destroy"),$("#UserSearch").selectpicker();for(var e=0;e<$("#userSearch_container .btn-group .dropdown-menu .selectpicker li").length;e++){var t=$("#userSearch_container .btn-group .dropdown-menu .selectpicker li").eq(e).find("a .text").text();$("#userSearch_container .btn-group .dropdown-menu .selectpicker li ").eq(e).find("a").attr("title",t)}$("#GroupSearch").selectpicker("destroy"),$("#GroupSearch").selectpicker();for(e=0;e<$("#groupSearch_container .btn-group .dropdown-menu .selectpicker li").length;e++){t=$("#groupSearch_container .btn-group .dropdown-menu .selectpicker li").eq(e).find("a .text").text();$("#groupSearch_container .btn-group .dropdown-menu .selectpicker li ").eq(e).find("a").attr("title",t)}$("#userSearch_container").on("click",".bs-select-all-custom",function(e){$("#userSearch_container").addClass("valueChanged"),$("#UserSearch").data("selectpicker").selectAll(),$(this).removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom"),$($(this).children("span")[0]).text(window.Server.App.LocalizationContent.Clear),e.stopPropagation()}),$("#groupSearch_container").on("click",".bs-select-all-custom",function(e){$("#groupSearch_container").addClass("valueChanged"),$("#GroupSearch").data("selectpicker").selectAll(),$(this).removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom"),$($(this).children("span")[0]).text(window.Server.App.LocalizationContent.Clear),e.stopPropagation()}),$("#userSearch_container").on("click",".bs-deselect-all-custom",function(e){$("#userSearch_container").addClass("valueChanged"),$("#UserSearch").data("selectpicker").deselectAll(),$(this).removeClass("bs-deselect-all-custom").addClass("bs-select-all-custom"),$($(this).children("span")[0]).text(window.Server.App.LocalizationContent.Select),$(".SelectedShareItems[data-searchtype='userSearch']").remove(),e.stopPropagation()}),$("#groupSearch_container").on("click",".bs-deselect-all-custom",function(e){$("#groupSearch_container").addClass("valueChanged"),$("#GroupSearch").data("selectpicker").deselectAll(),$(this).removeClass("bs-deselect-all-custom").addClass("bs-select-all-custom"),$($(this).children("span")[0]).text(window.Server.App.LocalizationContent.Select),$(".SelectedShareItems[data-searchtype='groupSearch']").remove(),e.stopPropagation()}),$("#userSearch_container").on("click",".bootstrap-select li a",function(e){if($("#userSearch_container").addClass("valueChanged"),$("#userSearch_container .bootstrap-select li.selected").length==$("#userSearch_container .bootstrap-select li").length&&($($("#userSearch_container div.bs-select-all-custom").children("span")[0]).text(window.Server.App.LocalizationContent.Clear),$("#userSearch_container div.bs-select-all-custom").removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom")),$(this).parent().hasClass("selected"))var t=$("#UserSearch").find("option")[parseInt($(this).parent().attr("data-original-index"))];else{t=$("#UserSearch").find("option")[parseInt($(this).parent().attr("data-original-index"))];$(".SelectedShareItems[id='"+$(t).val()+"']").remove(),$($("#userSearch_container .bs-deselect-all-custom").children("span")[0]).text(window.Server.App.LocalizationContent.Select),$("#userSearch_container .bs-deselect-all-custom").removeClass("bs-deselect-all-custom").addClass("bs-select-all-custom")}e.stopPropagation()}),$("#groupSearch_container").on("click",".bootstrap-select .dropdown-menu .selectpicker li a",function(e){if($("#groupSearch_container").addClass("valueChanged"),$("#groupSearch_container .bootstrap-select li.selected").length==$("#groupSearch_container .bootstrap-select li").length&&($($("#groupSearch_container div.bs-select-all-custom").children("span")[0]).text(window.Server.App.LocalizationContent.Clear),$("#groupSearch_container div.bs-select-all-custom").removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom")),$(this).parent().hasClass("selected"))var t=$("#GroupSearch").find("option")[parseInt($(this).parent().attr("data-original-index"))];else{t=$("#GroupSearch").find("option")[parseInt($(this).parent().attr("data-original-index"))];$(".SelectedShareItems").filter("[data-searchtype='groupSearch']").filter("#"+$(t).val()).remove(),$($("#groupSearch_container .bs-deselect-all-custom").children("span")[0]).text(window.Server.App.LocalizationContent.Select),$("#groupSearch_container .bs-deselect-all-custom").removeClass("bs-deselect-all-custom").addClass("bs-select-all-custom")}e.stopPropagation()}),$("#groupSearch_container").click(function(){$("#groupSearch_container").addClass("valueChanged"),$("#groupSearch_container .bootstrap-select li.selected").length==$("#groupSearch_container .bootstrap-select li").length&&$($("#groupSearch_container div.bs-deselect-all-custom").children("span")[0]).text(window.Server.App.LocalizationContent.Clear)}),$("#userSearch_container").click(function(){$("#userSearch_container").addClass("valueChanged"),$("#userSearch_container .bootstrap-select li.selected").length==$("#userSearch_container .bootstrap-select li").length&&$($("#userSearch_container div.bs-deselect-all-custom").children("span")[0]).text(window.Server.App.LocalizationContent.Clear)}),$("#UserSearch option").length>0?$(".share-popup #userSearch_container .bs-deselect-all").after("<div class='bs-select-all-custom'><span>"+window.Server.App.LocalizationContent.Select+"</span><span class='bs-select-custom-tick glyphicon glyphicon-ok'></span></div>"):$(".share-popup #userSearch_container .bs-deselect-all").after("<span class='noResult'>"+window.Server.App.LocalizationContent.NoResult+"</span>"),$("#GroupSearch option").length>0?$(".share-popup #groupSearch_container .bs-deselect-all").after("<div class='bs-select-all-custom'><span>"+window.Server.App.LocalizationContent.Select+"</span><span class='bs-select-custom-tick glyphicon glyphicon-ok'></span></div>"):$(".share-popup #groupSearch_container .bs-deselect-all").after("<span class='noResult'>"+window.Server.App.LocalizationContent.NoResult+"</span>"),parent.$("#sharepopup_wrapper_WaitingPopup").css("display","none")}function refreshUserGroupList(){var e=parent.document.getElementById("viewShare_popup_iframe"),t=e.contentDocument||e.contentWindow.document;$(t).find(".share-popup #userSearch_container .bs-deselect-all-custom,.share-popup #userSearch_container .bs-select-all-custom,.share-popup #userSearch_container .noResult").remove(),$(t).find(".share-popup #groupSearch_container .bs-deselect-all-custom,.share-popup #groupSearch_container .bs-select-all-custom,.share-popup #groupSearch_container .noResult").remove();for(var a=0;a<$("#userSearch_container .btn-group .dropdown-menu .selectpicker li").length;a++){var n=$("#userSearch_container .btn-group .dropdown-menu .selectpicker li").eq(a).find("a .text").text();$("#userSearch_container .btn-group .dropdown-menu .selectpicker li ").eq(a).find("a").attr("title",n)}for(a=0;a<$("#groupSearch_container .btn-group .dropdown-menu .selectpicker li").length;a++){n=$("#groupSearch_container .btn-group .dropdown-menu .selectpicker li").eq(a).find("a .text").text();$("#groupSearch_container .btn-group .dropdown-menu .selectpicker li ").eq(a).find("a").attr("title",n)}$("#UserSearch option").length>0?$("#UserSearch option").length==$("#UserSearch option:selected").length?$(".share-popup #userSearch_container .bs-deselect-all").after("<div class='bs-deselect-all-custom'><span>"+window.Server.App.LocalizationContent.Clear+"</span><span class='bs-select-custom-tick glyphicon glyphicon-ok'></span></div>"):$(".share-popup #userSearch_container .bs-deselect-all").after("<div class='bs-select-all-custom'><span>"+window.Server.App.LocalizationContent.Select+"</span><span class='bs-select-custom-tick glyphicon glyphicon-ok'></span></div>"):$(".share-popup #userSearch_container .bs-deselect-all").after("<span class='noResult'>"+window.Server.App.LocalizationContent.NoResult+"</span>"),$("#GroupSearch option").length>0?$("#GroupSearch option").length==$("#GroupSearch option:selected").length?$(".share-popup #groupSearch_container .bs-deselect-all").after("<div class='bs-deselect-all-custom'><span>"+window.Server.App.LocalizationContent.Clear+"</span><span class='bs-select-custom-tick glyphicon glyphicon-ok'></span></div>"):$(".share-popup #groupSearch_container .bs-deselect-all").after("<div class='bs-select-all-custom'><span>"+window.Server.App.LocalizationContent.Select+"</span><span class='bs-select-custom-tick glyphicon glyphicon-ok'></span></div>"):$(".share-popup #groupSearch_container .bs-deselect-all").after("<span class='noResult'>"+window.Server.App.LocalizationContent.NoResult+"</span>")}function onviewShareDialogClose(){var e=parent.document.getElementById("viewShare_popup_iframe");(e.contentDocument||e.contentWindow.document).documentElement.innerHTML="",parent.$("#viewShare_popup").ejDialog("close")}function ShareView(e){var t=$(window).width(),a=$(window).height(),n=$("#viewShare_popup").width(),i=$("#viewShare_popup").height(),o=(parseInt(t)-parseInt(n))/2,r=(parseInt(a)-parseInt(i))/2;$("#viewShare_popup").css({left:o,top:r}),$("#viewShare_popup,.ViewShare_popup_shadow").css("display","block"),$("#sharepopup_wrapper_WaitingPopup").css("display","block"),$("#viewShare_popup_iframe").attr("src",itemViewShareIframeUrl+"?itemId="+e)}function ShareviewSubmitCancel(){var e=parent.document.getElementById("viewShare_popup_iframe");(e.contentDocument||e.contentWindow.document).documentElement.innerHTML="",parent.$("#viewShare_popup,.ViewShare_popup_shadow").css("display","none")}$(document).on("click","#license-warning-designer",function(){var e=window.Server.App.LocalizationContent.LicenseWarningContent1+"<div class='license-warning-content'>"+window.Server.App.LocalizationContent.LicenseWarningContent2+"<a class='text-decoration-none' href='"+idpUrl+"/ums/administration/license-settings?product=enterprise-reporting'>"+window.Server.App.LocalizationContent.LicenseWarningContent3+"</a>"+window.Server.App.LocalizationContent.LicenseWarningContent4,t=document.createElement("style");t.innerHTML="\n        #license-warning-designer-item-dialog .e-icon-btn {\n            top: -3px;\n            left: -3px;\n            position: relative;\n        }\n\n        #license-warning-designer-item-dialog .e-icon-btn .e-icons {\n            height: 14px;\n            left: -2px;\n            top: 4px;\n            position: absolute;\n            width: 21px;\n        }\n    ",document.head.appendChild(t);var a=document.createElement("div");a.setAttribute("id","license-warning-designer-item-dialog");var n=document.createElement("div");n.setAttribute("id","content-area"),document.body.appendChild(n),document.getElementById("content-area").appendChild(a);var i=new ejs.popups.Dialog({header:window.Server.App.LocalizationContent.LicenseWarningHeader,showCloseIcon:!0,content:e,buttons:[{click:function(){i.hide()},buttonModel:{content:window.Server.App.LocalizationContent.CancelButton}}],width:"400px",isModal:!0});i.appendTo(a)}),$(document).on("click","#license-warning",function(){var e=window.Server.App.LocalizationContent.LicenseWarningContent1+"<div class='license-warning-content'>"+window.Server.App.LocalizationContent.LicenseWarningContent2+"<a class='text-decoration-none' href='"+idpUrl+"/ums/administration/license-settings?product=enterprise-reporting'>"+window.Server.App.LocalizationContent.LicenseWarningContent3+"</a>"+window.Server.App.LocalizationContent.LicenseWarningContent4,t=document.createElement("style");t.innerHTML="\n        #license-warning-item-dialog .e-icon-btn {\n            top: -3px;\n            left: -3px;\n            position: relative;\n        }\n\n        #license-warning-item-dialog .e-icon-btn .e-icons {\n            height: 14px;\n            left: -2px;\n            top: 4px;\n            position: absolute;\n            width: 21px;\n        }\n    ",document.head.appendChild(t);var a=document.createElement("div");a.setAttribute("id","license-warning-item-dialog");var n=document.createElement("div");n.setAttribute("id","content-area"),document.body.appendChild(n),document.getElementById("content-area").appendChild(a);var i=new ejs.popups.Dialog({header:window.Server.App.LocalizationContent.LicenseWarningHeader,showCloseIcon:!0,content:e,buttons:[{click:function(){i.hide()},buttonModel:{content:window.Server.App.LocalizationContent.CancelButton}}],width:"400px",isModal:!0});i.appendTo(a)}),$(document).on("click",".listing-dropdown .dropdown-toggle",function(e){$(".listing-dropdown .dropdown-menu").not($(this).next()).removeClass("show")}),$(document).on("click",function(e){let t=$(".listing-dropdown .dropdown-menu.show");$(e.target).closest(".listing-dropdown").length||t.length&&t.removeClass("show")}),$(document).ready(function(){$("#permission_delete_confirmation").ejDialog({width:window.innerWidth>410?"400px":window.innerWidth-10,showOnInit:!1,allowDraggable:!1,enableResize:!1,height:"187px",showHeader:!1,title:window.Server.App.LocalizationContent.Deleteuser,enableModal:!0,close:"onPermissionDeleteDialogClose",closeOnEscape:!0,open:"onPermissionDeleteDialogOpen"}),$("#messageBox").ejDialog({width:window.innerWidth>460?"450px":window.innerWidth-10,showOnInit:!1,allowDraggable:!0,enableResize:!1,height:"auto",showHeader:!1,enableModal:!0,close:"onMessageDialogClose"});var e=createLoader("permission_delete_confirmation_wrapper");$("#permission_delete_confirmation_wrapper").ejWaitingPopup({template:$("#"+e)});var t=createLoader("MasterContainer");$("#MasterContainer").ejWaitingPopup({template:$("#"+t)}),$(document).on("click","#SubscribersPanel .i-selected-cancel",function(e){var t=$(this).parents(".SelectedShareItems").attr("id"),a=$(this).parents(".SelectedShareItems").attr("data-searchtype");"userSearch"==a?(currentElementIndex=$("#UserSearch").find("[value='"+t+"']").index(),$("#userSearch_container .bootstrap-select li").filter("[data-original-index='"+currentElementIndex+"']").find("a").click()):"groupSearch"==a&&(currentElementIndex=$("#GroupSearch").find("[value='"+t+"']").index(),$("#groupSearch_container .bootstrap-select li").filter("[data-original-index='"+currentElementIndex+"']").find("a").click())}),$("#schedule_Submit").on("click",function(){var e=$("#UserSearch").val(),t=$("#GroupSearch").val(),a=$("#hiddenItemId").val(),n=$("#IsPublic").data("ejCheckBox").model.checked;$("#isPublicHiddenValue").val().toLowerCase();null!=e||null!=t||1==n?($("#validationMessage").css("display","none"),$.ajax({type:"POST",url:addItemViewPermissionUrl,data:{shareList:JSON.stringify({UserList:e,GroupList:t,itemViewId:a,IsPublic:n})},beforeSend:function(){$("#MasterContainer").ejWaitingPopup("show")},success:function(e){$("#MasterContainer").ejWaitingPopup("hide"),messageBox("su-share",window.Server.App.LocalizationContent.ShareView,window.Server.App.LocalizationContent.ShareViewSuccess,"success",function(){$("#isPublicHiddenValue").val(n),refreshUserGroupList();var e=$("#UserGrid").data("ejGrid"),t=$("#GroupGrid").data("ejGrid"),a=$(".ListItems.selected").attr("data-grid");e.refreshContent(),t.refreshContent(),"usergrid"==a.toLowerCase()?$("#GroupGrid_WaitingPopup").hide():$("#UserGrid_WaitingPopup").hide(),onCloseMessageBox()})}})):$("#validationMessage").css("display","block")}),$(".ListItems").click(function(){var e=$(this).attr("data-grid");$(".ListItems").removeClass("selected"),$(".ListItems[data-grid='"+e+"']").addClass("selected"),$(".itemGrid").removeClass("active"),$("#"+e).parent(".itemGrid").addClass("active"),$(".ListItems").parent("li").removeClass("active"),$(".selected").parent("li").addClass("active")}),$(".scheduleEditPopup").on("click",function(){var e=parent.document.getElementById("viewShare_popup_iframe");(e.contentDocument||e.contentWindow.document).documentElement.innerHTML="",parent.$("#viewShare_popup,.ViewShare_popup_shadow").css("display","none")})});var containSaveFilter=!1,SaveFilterName="",CanUpdate=!1,initialQueryString="",saveQueryString="",parameterArray=[],valueArray=[],isFirstRequest=!0,parentRefUrl=window.location!=window.parent.location?"":document.location.href.replace(document.location.pathname+document.location.search,"");if(""==parentRefUrl)var parentUrl="";else parentUrl=parentRefUrl.match(/:\/\/(.[^/]+)/)[1];var iframeRefUrl=window.location.href,iframeUrl=iframeRefUrl.match(/:\/\/(.[^/]+)/)[1];function openViews(){$('body [data-bs-toggle="tooltip"]').tooltip("hide"),containSaveFilter&&$("#saved-filter").show(),$("#sync_report_viewer").toggleClass("sync_report_viewer"),$(".view-heading").toggle(),$("#report-views").toggle();var e=document.getElementById("report-views");"block"==e.style.display||""==e.style.display?($("#expand-collapse").css("background-color","transparent"),$("#expand-collapse").css("box-shadow","none"),$("#header-pane").removeClass("no-border"),$(".PopupClose").addClass(".show-view-panel")):($("#header-pane").addClass("no-border"),$(".PopupClose").removeClass(".show-view-panel")),$("#report-view-toogle").toggleClass("report-view-toogle"),GetSavedFilter(),refreshScroller()}$(document).ready(function(){var e=createLoader("report-view-toogle");$("#report-view-toogle").ejWaitingPopup({template:$("#"+e)}),parent.initializeDeleteDialog(),$('[data-bs-toggle="tooltip"]').tooltip()});var filtered_Values="",reportviewerObj=null;function CloseReportView(){containSaveFilter&&$("#saved-filter").show(),$(".view-heading").toggle(),$("#report-views").toggle(),$(".PopupClose").removeClass(".show-view-panel"),$("#close-view .PopupClose").css("display","none"),$("#expand-collapse").html('<span class="su su-sidebar-collapse"></span>'),$("#expand-collapse").attr("data-original-title",window.Server.App.LocalizationContent.ReportViews),$("#report-view-toogle").toggleClass("report-view-toogle")}function filterView(e){if(viewReportClickFlag)viewReportClickFlag=!1;else{parent.document.getElementById("sync_report_viewer");var t=(reportviewerObj=parent.$("#sync_report_viewer").data("boldReportViewer")).getParameters();null!=t[0]&&"undefined"!=t[0].Name&&SavedViewHeight(),null!=e.reportParameters&&unsavedFilters(e=e.reportParameters)}GetSavedFilter(),refreshScroller()}function GetSavedFilter(){reportviewerObj=parent.$("#sync_report_viewer").data("boldReportViewer");var e={itemId:reportId,UserId:userId,UserName:userName,itemType:3};$("#report-view-toogle").ejWaitingPopup("show"),parent.ajaxPostCall("POST",getSavedViewUrl,e,null,getViewsResult,errorViewResult,null)}function getViewsResult(e){$("#saved-filter").html("");var t='<div id="save-view-label"><label class="save-filter-head">'+window.Server.App.LocalizationContent.SavedViews+'</label></div><div id="saved-list" style="display: block"><div class="saved-list-content-div" style="float: left">',a=embedConfig.IsEmbedCode?e.ResponseContent:jQuery.parseJSON(e.Result);if(a.length>0){containSaveFilter=!0,$("#saved-filter").show();for(var n=0;n<a.length;n++){var i=a[n].ViewId,o=a[n].ViewName,r="";r=a[n].CanDelete&&a[n].CanShare&&!embedConfig.IsEmbedCode&&!isHideIconBasedOnDnsName?'<div class="saved-opt"><span class="opt" viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'"><span viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'"  class = "delete su su-delete cursor-pointer" data-bs-toggle="tooltip" data-original-title="'+window.Server.App.LocalizationContent.Delete+'" ></span></span><span class="opt" viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'"><span  viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'" class = "share su su-share  cursor-pointer" data-bs-toggle="tooltip" data-original-title="'+window.Server.App.LocalizationContent.Share+'"></span></span><span class="opt" viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'"><span  viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'" class ="su su-link View-link-copy cursor-pointer" data-original-title="'+window.Server.App.LocalizationContent.LinkCopy+'" data-bs-toggle="tooltip" data-bs-placement="top" title=""></span></span></div>':a[n].CanDelete?'<div class="saved-opt"><span class="opt" viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'"><span viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'"  class = "delete su su-delete cursor-pointer" data-bs-toggle="tooltip" data-original-title="'+window.Server.App.LocalizationContent.Delete+'" ></span></span><span class="opt" viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'"><span  viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'" class = "su su-link View-link-copy cursor-pointer" data-original-title="'+window.Server.App.LocalizationContent.LinkCopy+'" data-bs-toggle="tooltip" data-bs-placement="top" title=""></span></span></div>':a[n].CanShare&&!embedConfig.IsEmbedCode?'<div class="saved-opt"><span class="opt" viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'"><span  viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'" class = "share su su-share  cursor-pointer" data-bs-toggle="tooltip" data-original-title="'+window.Server.App.LocalizationContent.Share+'"></span></span><span class="opt" viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'"><span  viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'" class = "su su-link View-link-copy cursor-pointer" data-original-title="'+window.Server.App.LocalizationContent.LinkCopy+'" data-bs-toggle="tooltip" data-bs-placement="top" title=""></span></span></div>':'<div class="saved-opt"><span class="opt" viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'"><span  viewid="'+i+'" itemId="'+reportId+'" viewname="'+a[n].ViewName+'" class = "su su-link View-link-copy cursor-pointer" data-original-title="'+window.Server.App.LocalizationContent.LinkCopy+'" data-bs-toggle="tooltip" data-bs-placement="top" title=""></span></span></div>',pageurl.indexOf("/embed/")>-1&&(pageurl=pageurl.replace("/embed/","/")),t+='<li class="saved-view" viewid="'+i+'">'+r+'<label class="saved-filter cursor-pointer txt-overflow" viewid="'+i+'" itemId="'+reportId+'"><a class="view-link txt-overflow saved-filter-anchor" href="'+pageurl+"?viewname="+o+'" data-url="'+pageurl+"?viewname="+o+'" target="_blank" data-bs-toggle="tooltip" data-original-title="'+a[n].ViewName+'">'+a[n].ViewName+"</a></label></li>"}if($("#saved-filter").append(t+"</div></div>"),0==$("#saved-filter").length){var s=parent.$(".view-link").attr("data-url");for(n=0;n<s.length;n++)parent.$(".view-link").eq(n).attr("href",parent.$(".view-link").eq(n).attr("data-url"))}else for(s=$(".view-link").attr("data-url"),n=0;n<s.length;n++)$(".view-link").eq(n).attr("href",$(".view-link").eq(n).attr("data-url"));/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&($(".View-link-copy").removeClass("su su-copy"),$(".View-link-copy").attr("data-original-title","")),$("#report-view-toogle").show(),$('[data-bs-toggle="tooltip"]').tooltip()}else containSaveFilter=!1,$("#saved-filter").show(),$("#saved-filter").append(t+'<span class="no-views" href="javascript:void(0);"><span>'+window.Server.App.LocalizationContent.NoSavedViews+"</span></span></div></div>"),reportviewerObj=$("#sync_report_viewer").data("boldReportViewer");embedConfig.IsEmbedCode&&$(".su-link").hide(),$("#report-view-toogle").ejWaitingPopup("hide"),SavedViewHeight(),refreshScroller()}function errorViewResult(){SavedViewHeight(),refreshScroller()}$(function(){$("#expand-collapse").html('<span class="su su-sidebar-collapse"></span>'),$('[data-bs-toggle="tooltip"]').tooltip()}),$(document).on("click","#clear",function(){(reportviewerObj=$("#sync_report_viewer").data("boldReportViewer")).reload()}),$(document).on("click",".view",function(){var e=$(this).attr("viewid");window.open(window.location.pathname+"?viewid="+e,"_blank")}),$(document).on("click",".share",function(){var e=$(this).attr("viewid");$("#report-view-toogle").css("z-index","999"),$.ajax({type:"POST",url:itemViewShareIframeUrl,data:{itemViewId:e,itemId:reportId},success:function(e){null!=e.itemViewDetail&&null!=e.itemDetail&&(parent.$("#sharePermissionPopup_iframe").show(),parent.document.getElementById("sharePermissionPopup_iframe").contentWindow.shareDashboardPermission(e.itemViewDetail,e.itemDetail))}})}),$(document).on("click",".clear",function(){$("#filter_name").val(""),(reportviewerObj=$("#sync_report_viewer").data("boldReportViewer")).reload(),GetSavedFilter(),$("#view-name").show(),$("#save-section").hide(),$("#unsaved-filter").show(),$("#save-lable-section").show(),$("#update-view").removeClass("pointer-events"),$("#update-view").css("opacity",1)}),$(document).on("click","#clear-txt",function(){$("#filter_name").val(""),$("#save-lable-section").show(),$("#save-section").hide()});var deletedViewId="";function SavedViewHeight(){if("none"!=$("#save-view-label").css("display")){var e=parent.$("#viewModuleContainer").height()-60;return $("#saved-list").css("height",e),e}}function getFnObj(e){return"function"==typeof e||"string"==typeof e&&window[e]?e:void 0}function refreshScroller(){var e;if(e=SavedViewHeight(),$("#saved-list").length){$("#saved-list").ejScroller({height:e,width:"100%",scrollerSize:6,buttonSize:0,enableTouchScroll:iframeUrl==parentUrl?"false"!=parent.$("#is_mobile").val():"false"!=$("#is_mobile").val()});var t=$("#saved-list").ejScroller("instance");if(t.model.height=e,t.refresh(),$("#saved-list .e-scrollbar").show(),$("#saved-filter .e-vhandle").length){var a=$("#saved-filter .e-vhandle");if("none"!=a.css("display")){var n=a.height()+29;a.css("height",n)}}}}$(document).on("click",".delete",function(e){var t=e.target.attributes.viewid.value,a=e.target.attributes.viewname.value;parent.onDeleteViewDialogOpen(),parent.onDeleteViewClicked(t,a)}),$(document).on("click",".View-link-copy",function(e){ej.browserInfo();if($(e.target).parents().closest("li").length){var t=$(e.target).parents().closest("li");if(t.find(".view-link").length){var a=document.createElement("textarea");a.id="copyTextArea",a.value=window.location.origin+t.find(".view-link").attr("href"),document.body.appendChild(a),document.getElementById("copyTextArea").select();var n=this;if(/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor))$(n).removeClass("su su-copy"),$(n).attr("data-bs-original-title","");else{document.execCommand("copy"),$(n).attr("data-bs-original-title",window.Server.App.LocalizationContent.Copysuccess);var i=bootstrap.Tooltip.getInstance(n)||new bootstrap.Tooltip(n);i.show(),setTimeout(function(){$(n).attr("data-bs-original-title",window.Server.App.LocalizationContent.LinkCopy),i.hide()},3e3)}document.body.removeChild(a)}}});var containsFilter=!1,viewReportClickFlag=!1;function viewReportClick(e){viewReportClickFlag=!0;$("#current-views-head").show();(reportviewerObj=parent.$("#sync_report_viewer").data("boldReportViewer")).getParameters();for(var t=0;t<e.parameters.length;t++){t>=1&&"<hr/>","<li class='unsaved-filter'><div class='param-name'>"+e.parameters[t].name+"</div><div class='param-value' rel='tooltip' data-bs-placement='left' data-original-title='"+e.parameters[t].labels+"'>"+appliedParametersForUI(e.parameters[t])+"</div></li>"}saveQueryString=QueryStringFormation(e.parameters,!0);var a="";if(null!=$("#report-filter-query-name").val()&&null!=$("#report-filter-query-value").val()&&null!=parameterArray&&null!=valueArray)for(t=0;t<parameterArray.length;t++)a+=parameterArray[t]+"="+valueArray[t]+"&";a=a.slice(0,-1),iframeUrl==parentUrl?parent.window.innerWidth>=1041&&null!=parent.history.pushState&&parent.history.pushState(a,"",parent.location.href):window.innerWidth>=1041&&null!=history.pushState&&history.pushState(a,"",location.href),$("[rel=tooltip]").tooltip({html:!0}),refreshScroller()}function appliedParametersForUI(e){for(var t="",a=0;a<e.values.length;a++)t=viewReportClickFlag?e.labels:"DateTime"==e.DataType?null==e.values?e.Value:e.values[a]:null===e.Labels||"undefined"===e.Labels||""===e.Labels?e.Label:e.values[a];return t}function unsavedFilters(e){reportviewerObj=parent.$("#sync_report_viewer").data("boldReportViewer");var t="";$("#unsaved-filter-head").show(),jQuery.each(e,function(a,n){if($.isNumeric(a)){a>=1&&(t+="<hr/>");var i=null==e[a].name?e[a].Name:e[a].name;t+="<li class='unsaved-filter'><div class='param-name'>"+i+"</div><div class='param-value'rel='tooltip' data-bs-placement='left' data-original-title='"+e[a].values[a]+"'>"+appliedParametersForUI(e[a])+"</div></li>"}}),saveQueryString=initialQueryString=QueryStringFormation(e,isFirstRequest);var a="";if(null!=$("#report-filter-query-name").val()&&null!=$("#report-filter-query-value").val()&&null!=parameterArray&&null!=valueArray)for(i=0;i<parameterArray.length;i++)a+=parameterArray[i]+"="+valueArray[i]+"&";a=a.slice(0,-1),iframeUrl==parentUrl?isFirstRequest&&parent.window.innerWidth>=1041&&null!=parent.history.pushState&&parent.history.pushState(a,"",parent.location.href):isFirstRequest&&window.innerWidth>=1041&&null!=history.pushState&&history.pushState(a,"",location.href),isFirstRequest=!1,$("#unsaved-filter-parameter").show(),$("#unsaved-filter-parameter").html(""),$("#unsaved-filter-parameter").append(t),$("#unsaved-filter,#unsaved-filter-parameter").show(),$("#save-lable-section").show(),$("[rel=tooltip]").tooltip({html:!0})}function onCloseMessageBox(){$("#messageBox").ejDialog("close")}function onMessageDialogClose(){$("#messageBox").find(".message-content").text(""),$(".message-box-btn-holder").html(""),$(".message-box-close").html("")}function messageBox(e,t,a,n,i,o,r,s,l){var c,p,d;($("#messageBox").find(".message-content").text(""),$(".message-box-btn-holder").html(""),$(".message-box-close").html(""),$("#messageBox").find(".message-header").html("<span class='su "+e+"'></span> <span class='modal-title'  data-bs-toggle='tooltip' data-bs-placement='bottom' data-container='body' title='"+t+"'  >"+t+"</h2>"),$("#messageBox").find(".message-content").html(a),"error"==n)?(null!=i&&(p=$("<input type='button' class='critical-action-button app-btn-danger float-end' value='"+window.Server.App.LocalizationContent.Yes+"'></input>")).bind("click",$.proxy(getFnObj(i),window)),null!=o?((c=$("<input type='button' class='secondary-button app-btn-secondary float-end' value='"+window.Server.App.LocalizationContent.No+"'></input>")).bind("click",$.proxy(getFnObj(o),window)),(d=$('<span class="su su-close"></span>')).bind("click",$.proxy(getFnObj(o),window))):(c=$("<input type='button' class='secondary-button app-btn-secondary float-end' value='"+window.Server.App.LocalizationContent.No+"'></input>"),d=$('<span class="su su-close"></span>'),c.click(function(){onCloseMessageBox()}),d.click(function(){onCloseMessageBox()})),$(".message-box-close").html(d),$(".message-box-btn-holder").append(c,p),$("#messageBox").unbind("keydown")):(null!=i?((p=$("<input type='button' class='secondary-button app-btn-secondary' value='"+window.Server.App.LocalizationContent.Ok+"'></input>")).bind("click",$.proxy(getFnObj(i),window)),(d=$('<span class="su su-close"></span>')).bind("click",$.proxy(getFnObj(i),window))):(p=$("<input type='button' class='secondary-button app-btn-secondary' value='"+window.Server.App.LocalizationContent.Ok+"'></input>"),d=$('<span class="su su-close"></span>'),p.click(function(){onCloseMessageBox()}),d.click(function(){onCloseMessageBox()})),$(".message-box-close").html(d),$(".message-box-btn-holder").append(p),$("#messageBox").on("keydown",function(e){switch(e.keyCode){case 13:case 27:p.click()}}));$('[data-bs-toggle="tooltip"]').tooltip(),$("#messageBox").ejDialog("open"),$("#messageBox").focus(),setTimeout(function(){var e=$("#messageBox").data("ejDialog");null!=r&&e.option("width",r),window.innerWidth>1040&&null==s&&(s=$("#messageBox").find(".modal-content").height()+135+"px"),e.option("height",s),null!=l&&e.option("maxHeight",l)},50)}function QueryStringFormation(e,t){return reportviewerObj=parent.$("#sync_report_viewer").data("boldReportViewer"),parameterArray=[],valueArray=[],jQuery.each(e,function(a,n){if($.isNumeric(a)){if(null==e[a].IsMultiValue)var i=e[a].values;else i=e[a].IsMultiValue?e[a].Values:null!=e[a].Value?e[a].Value:e[a].Values;var o=null==e[a].name?e[a].Name:e[a].name;t&&(parameterArray.push(o),valueArray.push(i))}}),t&&(parent.$("#report-filter-query-name").val(JSON.stringify(parameterArray)),parent.$("#report-filter-query-value").val(JSON.stringify(valueArray))),e.map(e=>JSON.stringify(e,(e,t)=>{if("dateTimeInfo"!==e&&"labels"!==e)return t})).join(",")}var sessionData=!1,isSession=!1;function SuccessAlert(e,t,a){window.top.$("#success-alert").css("display","table"),window.top.$("#message-header").html(e),window.top.$("#message-content").html(t),setTimeout(function(){window.top.$("#success-alert").fadeOut()},a)}function WarningAlert(e,t,a){parent.$("#warning-alert").css("display","table"),parent.$("#warning-alert #message-header").html(e),parent.$(" #warning-alert #message-content").html(t),null!=a&&""!=a&&setTimeout(function(){parent.$("#warning-alert").fadeOut()},a),$(document).on("click",".close-div",function(){parent.$("#warning-alert").fadeOut()})}function isUrlHasView(){const e=new URLSearchParams(window.location.search);return!(!e.has("viewname")&&!e.has("viewid"))}function getUrlVars(e){var t={};e.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,a,n){t[a]=n});return t}function extractXSRFTokenFromCookie(){var e=parent.document.cookie.split("; ").find(e=>e.startsWith("XSRF-TOKEN="));return e?e.split("=")[1]:null}function setXSRFRequestHeader(e){e.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())}function decodeHtmlAsString(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}function EscapeHtml(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}$(document).ready(function(){if("undefined"==typeof canCheckSession||isPublic||(isSession=Boolean(canCheckSession)),isSession){function e(){$.ajax({type:"GET",url:isSessionActiveUrl,success:function(n){n.isactive?setTimeout(function(){e()},18e4):(function(){if($(".e-btn-icon.e-icon-dlg-close.e-icons").is(":visible")){var e=$(".e-btn-icon.e-icon-dlg-close.e-icons:visible");$.each(e,function(e,t){var a=$(t).parents(".e-dialog").attr("id");null==a&&null==a||document.getElementById(a).ej2_instances[0].hide()})}if($(".popup-close").is(":visible")){var t=$(".popup-close:visible");$.each(t,function(e,t){var a=$(t).parents(".e-dialog").attr("id");null==a&&null==a||(eDialog=$("#"+a).data("ejDialog"),eDialog.close())})}}(),function(){if("undefined"!=typeof isViewerV2Enabled&&!isViewerV2Enabled||"undefined"!=typeof isDesignerV2Enabled&&!isDesignerV2Enabled){var e=$("#messageBox").data("ejDialog");null==e&&($("#messageBox").ejDialog({width:parent.window.innerWidth>460?"450px":parent.window.innerWidth-10,height:"150px",showOnInit:!1,allowDraggable:!0,enableResize:!1,showHeader:!1,enableModal:!0,close:"onMessageDialogClose"}),e=$("#messageBox").data("ejDialog")),messageBox("",window.Server.App.LocalizationContent.SessionHeader,window.Server.App.LocalizationContent.SessionContent,"success",t)}else{var n="",i='<span class ="dialog-header-title">'+window.Server.App.LocalizationContent.SessionHeader+"</span>";if(!sessionData){var o=document.createElement("div");o.setAttribute("id","session-time-dialog");var r=document.getElementById("content-area");if(null==r){var s=document.createElement("div");s.setAttribute("id","content-area"),document.body.appendChild(s),r=document.getElementById("content-area")}n=ejs.popups,r.appendChild(o);var l=window.Server.App.LocalizationContent.SessionContent;new n.Dialog({showOnInit:!1,allowDraggable:!1,enableResize:!1,width:window.innerWidth>500?"470px":window.innerWidth-10,height:"auto",showHeader:!1,isModal:!0,enableModal:!0,closeOnEscape:!0,header:i,close:"closeDialog",showCloseIcon:!0,content:l,buttons:[{click:function(e){t()},buttonModel:{cssClass:"app-btn-secondary",content:window.Server.App.LocalizationContent.OKButton}}],close:a}).appendTo(o),sessionData=!0}}}())}})}setTimeout(function(){e()},18e4)}function t(){location.reload()}function a(){location.reload()}}),$.ajaxSetup({beforeSend:function(e){setXSRFRequestHeader(e)}});
