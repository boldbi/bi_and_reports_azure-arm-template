var attributeGrid,styleSrcChipData=[],scriptSrcChipData=[],fontSrcChipData=[],imgSrcChipData=[],connectSrcChipData=[],frameSrcChipData=[],isStyleSrcChipBinded=!1,isScriptSrcsChipBinded=!1,isFontSrcChipBinded=!1,isImgSrcChipBinded=!1,isConnectSrcChipBinded=!1,isFrameSrcChipBinded=!1,isChrome=-1!=navigator.userAgent.indexOf("Chrome"),isEdge=-1!=navigator.userAgent.indexOf("Edge"),isEditing=!1,exisitingRuleName=null,existsIpAddress=null;function initializeTabs(){$("a[data-bs-toggle='tab']").off("click"),$("a[data-bs-toggle='tab']").on("click",function(t){t.preventDefault();var e=$(this).attr("href");$(e).addClass("active show").siblings(".tab-pane").removeClass("active show"),$(this).parent().addClass("active").siblings().removeClass("active");var c=e.substring(1);history.pushState(null,"","?tab="+c),"#csp-settings"==e?($(".online-help-link").attr("href",contentSecurityPolicyUrl),$("#update-csp-settings").show(),$("#update-x-frame-options-settings").hide(),$("#update-network-settings").hide()):"#x-frame-options"==e?($(".online-help-link").attr("href",xFrameOptionUrl),$("#update-csp-settings").hide(),$("#update-x-frame-options-settings").show(),$("#update-network-settings").hide()):"#network-settings"==e&&($(".online-help-link").attr("href",networkSettingsUrl),$("#update-csp-settings").hide(),$("#update-x-frame-options-settings").hide(),$("#update-network-settings").show())}),window.addEventListener("popstate",function(){var t=window.location.search.toLowerCase();t.includes("x-frame-options")?$("#x-frame-options-tab").trigger("click"):t.includes("network-settings")?$("#network-settings-tab").trigger("click"):$("#csp-settings-tab").trigger("click")})}function disableOrEnableCSPSettingsForm(){$("#enable-csp").is(":checked")?($(".src-input-class").removeClass("src-disabled"),$(".src-input-class .src-input-ship .e-chip").removeClass("disable-bg-color"),$(".txt-input-src").prop("disabled",!1)):($(".txt-input-src").val(""),$(".style-src-validation .script-src-validation .font-src-validation .img-src-validation .connect-src-validation .frame-src-validation").html(""),$(".src-input-class").addClass("src-disabled"),$(".src-input-class .src-input-ship .e-chip").addClass("disable-bg-color"),$(".txt-input-src").prop("disabled",!0),getSrcInstance("style-src-chip-content"),getSrcInstance("script-src-chip-content"),getSrcInstance("font-src-chip-content"),getSrcInstance("img-src-chip-content"),getSrcInstance("connect-src-chip-content"),getSrcInstance("frame-src-chip-content"),styleSrcChipData=[],scriptSrcChipData=[],fontSrcChipData=[],imgSrcChipData=[],connectSrcChipData=[],frameSrcChipData=[])}function objectConvertAsSrcDirectiveChip(t,e){(t.endsWith(",")||t.endsWith(";")||t.endsWith("\n"))&&(t=t.slice(0,-1).trim()),0!=t.length?isValidOrigin(t)?"txt-stylesrc"==e?(isSrcChipAlreadyExists(t,"style-src-chip-content")&&(styleSrcChipData.push(t),srcChipConversion(styleSrcChipData,"style-src-chip-content","#txt-stylesrc")),$("#"+e).parent().next().html("")):"txt-scriptsrc"==e?(isSrcChipAlreadyExists(t,"script-src-chip-content")&&(scriptSrcChipData.push(t),srcChipConversion(scriptSrcChipData,"script-src-chip-content","#txt-scriptsrc")),$("#"+e).parent().next().html("")):"txt-fontsrc"==e?(isSrcChipAlreadyExists(t,"font-src-chip-content")&&(fontSrcChipData.push(t),srcChipConversion(fontSrcChipData,"font-src-chip-content","#txt-fontsrc")),$("#"+e).parent().next().html("")):"txt-imgsrc"==e?(isSrcChipAlreadyExists(t,"img-src-chip-content")&&(imgSrcChipData.push(t),srcChipConversion(imgSrcChipData,"img-src-chip-content","#txt-imgsrc")),$("#"+e).parent().next().html("")):"txt-connectsrc"==e?(isSrcChipAlreadyExists(t,"connect-src-chip-content")&&(connectSrcChipData.push(t),srcChipConversion(connectSrcChipData,"connect-src-chip-content","#txt-connectsrc")),$("#"+e).parent().next().html("")):"txt-framesrc"==e&&(isSrcChipAlreadyExists(t,"frame-src-chip-content")&&(frameSrcChipData.push(t),srcChipConversion(frameSrcChipData,"frame-src-chip-content","#txt-framesrc")),$("#"+e).parent().next().html("")):($("#"+e).val(t),$("#"+e).parent().next().html(window.Server.App.LocalizationContent.CSPDirectiveValidation)):clearSettingsFields()}function srcChipConversion(t,e,c){if("#txt-stylesrc"==c)if(isStyleSrcChipBinded){var n=document.getElementById(e).ej2_instances;n[0].chips=[],n[0].chips=t,n[0].createChip(),n[0].refresh()}else new ejs.buttons.ChipList({chips:t,enableDelete:!0,delete:onStyleSrcChipDelete},"#"+e),isStyleSrcChipBinded=!0;else if("#txt-scriptsrc"==c)if(isScriptSrcsChipBinded){var i=document.getElementById("script-src-chip-content").ej2_instances;i[0].chips=[],i[0].chips=scriptSrcChipData,i[0].createChip(),i[0].refresh()}else new ejs.buttons.ChipList({chips:scriptSrcChipData,enableDelete:!0,delete:onScriptSrcChipDelete},"#script-src-chip-content"),isScriptSrcsChipBinded=!0;else if("#txt-fontsrc"==c)if(isFontSrcChipBinded){var s=document.getElementById("font-src-chip-content").ej2_instances;s[0].chips=[],s[0].chips=fontSrcChipData,s[0].createChip(),s[0].refresh()}else new ejs.buttons.ChipList({chips:fontSrcChipData,enableDelete:!0,delete:onFontSrcChipDelete},"#font-src-chip-content"),isFontSrcChipBinded=!0;else if("#txt-imgsrc"==c)if(isImgSrcChipBinded){var r=document.getElementById("img-src-chip-content").ej2_instances;r[0].chips=[],r[0].chips=imgSrcChipData,r[0].createChip(),r[0].refresh()}else new ejs.buttons.ChipList({chips:imgSrcChipData,enableDelete:!0,delete:onImgSrcChipDelete},"#img-src-chip-content"),isImgSrcChipBinded=!0;else if("#txt-connectsrc"==c)if(isConnectSrcChipBinded){var o=document.getElementById("connect-src-chip-content").ej2_instances;o[0].chips=[],o[0].chips=connectSrcChipData,o[0].createChip(),o[0].refresh()}else new ejs.buttons.ChipList({chips:connectSrcChipData,enableDelete:!0,delete:onConnectSrcChipDelete},"#connect-src-chip-content"),isConnectSrcChipBinded=!0;else if("#txt-framesrc"==c)if(isFrameSrcChipBinded){var a=document.getElementById("frame-src-chip-content").ej2_instances;a[0].chips=[],a[0].chips=frameSrcChipData,a[0].createChip(),a[0].refresh()}else new ejs.buttons.ChipList({chips:frameSrcChipData,enableDelete:!0,delete:onFrameSrcChipDelete},"#frame-src-chip-content"),isFrameSrcChipBinded=!0;if($("#"+e).height()>140){var l=document.getElementById(e);l.scrollTop=l.scrollHeight}removeSrcContainer(e,c),applySrcTooltip(e)}function applySrcTooltip(t){for(var e=0;e<$("#"+t+" .e-chip").length;e++){$("#"+t+" .e-chip")[e].setAttribute("data-bs-toggle","tooltip"),$("#"+t+" .e-chip")[e].setAttribute("data-bs-placement","top");var c=$("#"+t+" .e-chip > .e-chip-text")[e].innerText;$("#"+t+" .e-chip")[e].setAttribute("data-original-title",c)}$('[data-bs-toggle="tooltip"]').tooltip()}function removeSrcContainer(t,e){$(e).css("width","10%").removeAttr("placeholder").val(""),$("#"+t).css("display","inline")}function getSrcInstance(t){var e=document.getElementById(t).ej2_instances;"style-src-chip-content"==t?null!=e&&(e[0].chips=[],applySrcContainer("#txt-stylesrc")):"script-src-chip-content"==t?null!=e&&(e[0].chips=[],applySrcContainer("#txt-scriptsrc")):"font-src-chip-content"==t?null!=e&&(e[0].chips=[],applySrcContainer("#txt-fontsrc")):"img-src-chip-content"==t?null!=e&&(e[0].chips=[],applySrcContainer("#txt-imgsrc")):"connect-src-chip-content"==t?null!=e&&(e[0].chips=[],applySrcContainer("#txt-connectsrc")):"frame-src-chip-content"==t&&null!=e&&(e[0].chips=[],applySrcContainer("#txt-framesrc")),$("#"+t).html("")}function checkSrcValidation(t){var e=$("#"+t+".e-chip").toArray(),c=0;$("#"+t+".e-chip").each(function(){if(c<e.length){var n=$(e[c]).find(".e-chip-text").text();isValidOrigin(n)||($(this).addClass("chip-validation"),$("#"+t).parent().next().html.html(window.Server.App.LocalizationContent.CSPDirectiveValidation)),c++}})}function clearSettingsFields(){$("#txt-stylesrc").val(""),null==document.getElementById("style-src-chip-content").ej2_instances&&0==$("#txt-stylesrc").val().length&&applySrcContainer("#txt-stylesrc"),$("#txt-scriptsrc").val(""),null==document.getElementById("script-src-chip-content").ej2_instances&&0==$("#txt-scriptsrc").val().length&&applySrcContainer("#txt-scriptsrc"),$("#txt-fontsrc").val(""),null==document.getElementById("font-src-chip-content").ej2_instances&&0==$("#txt-fontsrc").val().length&&applySrcContainer("#txt-fontsrc"),$("#txt-imgsrc").val(""),null==document.getElementById("img-src-chip-content").ej2_instances&&0==$("#txt-imgsrc").val().length&&applySrcContainer("#txt-imgsrc"),$("#txt-connectsrc").val(""),null==document.getElementById("connect-src-chip-content").ej2_instances&&0==$("#txt-connectsrc").val().length&&applySrcContainer("#txt-connectsrc"),$("#txt-framesrc").val(""),null==document.getElementById("frame-src-chip-content").ej2_instances&&0==$("#txt-framesrc").val().length&&applySrcContainer("#txt-framesrc")}function applySrcContainer(t){"#txt-stylesrc"==t?($("#txt-stylesrc").css("width","100%").attr("placeholder",window.Server.App.LocalizationContent.CSPSourcePlaceholderContent),$("#style-src-chip-content").hide(),$(".style-src-validation").html("")):"#txt-scriptsrc"==t?($("#txt-scriptsrc").css("width","100%").attr("placeholder",window.Server.App.LocalizationContent.CSPSourcePlaceholderContent),$("#script-src-chip-content").hide(),$(".script-src-validation").html("")):"#txt-fontsrc"==t?($("#txt-fontsrc").css("width","100%").attr("placeholder",window.Server.App.LocalizationContent.CSPSourcePlaceholderContent),$("#font-src-chip-content").hide(),$(".font-src-validation").html("")):"#txt-imgsrc"==t?($("#txt-imgsrc").css("width","100%").attr("placeholder",window.Server.App.LocalizationContent.CSPSourcePlaceholderContent),$("#img-src-chip-content").hide(),$(".img-src-validation").html("")):"#txt-connectsrc"==t?($("#txt-connectsrc").css("width","100%").attr("placeholder",window.Server.App.LocalizationContent.CSPSourcePlaceholderContent),$("#connect-src-chip-content").hide(),$(".connect-src-validation").html("")):"#txt-framesrc"==t&&($("#txt-framesrc").css("width","100%").attr("placeholder",window.Server.App.LocalizationContent.CSPSourcePlaceholderContent),$("#frame-src-chip-content").hide(),$(".frame-src-validation").html(""))}function onStyleSrcChipDelete(){$("#txt-stylesrc").focus(),setTimeout(function(){$(".style-src-validation").html("")},100),1==document.getElementById("style-src-chip-content").ej2_instances[0].chips.length&&applySrcContainer("#txt-stylesrc")}function onScriptSrcChipDelete(){$("#txt-scriptsrc").focus(),setTimeout(function(){$(".script-src-validation").html("")},100),1==document.getElementById("script-src-chip-content").ej2_instances[0].chips.length&&applySrcContainer("#txt-scriptsrc")}function onFontSrcChipDelete(){$("#txt-fontsrc").focus(),setTimeout(function(){$(".font-src-validation").html("")},100),1==document.getElementById("font-src-chip-content").ej2_instances[0].chips.length&&applySrcContainer("#txt-fontsrc")}function onImgSrcChipDelete(){$("#txt-imgsrc").focus(),setTimeout(function(){$(".img-src-validation").html("")},100),1==document.getElementById("img-src-chip-content").ej2_instances[0].chips.length&&applySrcContainer("#txt-imgsrc")}function onConnectSrcChipDelete(){$("#txt-connectsrc").focus(),setTimeout(function(){$(".connect-src-validation").html("")},100),1==document.getElementById("connect-src-chip-content").ej2_instances[0].chips.length&&applySrcContainer("#txt-connectsrc")}function onFrameSrcChipDelete(){$("#txt-framesrc").focus(),setTimeout(function(){$(".frame-src-validation").html("")},100),1==document.getElementById("frame-src-chip-content").ej2_instances[0].chips.length&&applySrcContainer("#txt-framesrc")}function isSrcChipAlreadyExists(t,e){if("style-src-chip-content"==e){var c=document.getElementById("style-src-chip-content").ej2_instances;if(null!=c&&0!=c[0].chips&&null!=c[0].chips)for(i=0;i<c[0].chips.length;i++)if(c[0].chips[i].toLowerCase()==t.toLowerCase())return $("#txt-stylesrc").val(""),!1;return!0}if("script-src-chip-content"==e){var n=document.getElementById("script-src-chip-content").ej2_instances;if(null!=n&&0!=n[0].chips&&null!=n[0].chips)for(i=0;i<n[0].chips.length;i++)if(n[0].chips[i].toLowerCase()==t.toLowerCase())return $("#txt-scriptsrc").val(""),!1;return!0}if("font-src-chip-content"==e){var s=document.getElementById("font-src-chip-content").ej2_instances;if(null!=s&&0!=s[0].chips&&null!=s[0].chips)for(i=0;i<s[0].chips.length;i++)if(s[0].chips[i].toLowerCase()==t.toLowerCase())return $("#txt-fontsrc").val(""),!1;return!0}if("img-src-chip-content"==e){var r=document.getElementById("img-src-chip-content").ej2_instances;if(null!=r&&0!=r[0].chips&&null!=r[0].chips)for(i=0;i<r[0].chips.length;i++)if(r[0].chips[i].toLowerCase()==t.toLowerCase())return $("#txt-imgsrc").val(""),!1;return!0}if("connect-src-chip-content"==e){var o=document.getElementById("connect-src-chip-content").ej2_instances;if(null!=o&&0!=o[0].chips&&null!=o[0].chips)for(i=0;i<o[0].chips.length;i++)if(o[0].chips[i].toLowerCase()==t.toLowerCase())return $("#txt-connectsrc").val(""),!1;return!0}if("frame-src-chip-content"==e){var a=document.getElementById("frame-src-chip-content").ej2_instances;if(null!=a&&0!=a[0].chips&&null!=a[0].chips)for(i=0;i<a[0].chips.length;i++)if(a[0].chips[i].toLowerCase()==t.toLowerCase())return $("#txt-framesrc").val(""),!1;return!0}}function extractXSRFTokenFromCookie(){var t=parent.document.cookie.split("; ").find(t=>t.startsWith("XSRF-TOKEN="));return t?t.split("=")[1]:null}function setXSRFRequestHeader(t){t.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())}function decodeHtmlAsString(t){var e=document.createElement("textarea");return e.innerHTML=t,e.value}function EscapeHtml(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}$(document).ready(function(){if(getSrcInstance("style-src-chip-content"),getSrcInstance("script-src-chip-content"),getSrcInstance("font-src-chip-content"),getSrcInstance("img-src-chip-content"),getSrcInstance("connect-src-chip-content"),getSrcInstance("frame-src-chip-content"),null!=styleSourcesList&&""!=styleSourcesList)for(i=0;i<styleSourcesList.length;i++)styleSrcChipData[i]=styleSourcesList[i],0!=styleSrcChipData[i].length&&srcChipConversion(styleSrcChipData,"style-src-chip-content","#txt-stylesrc");if(null!=scriptSourcesList&&""!=scriptSourcesList)for(i=0;i<scriptSourcesList.length;i++)scriptSrcChipData[i]=scriptSourcesList[i],0!=scriptSrcChipData[i].length&&srcChipConversion(scriptSrcChipData,"script-src-chip-content","#txt-scriptsrc");if(null!=fontSourcesList&&""!=fontSourcesList)for(i=0;i<fontSourcesList.length;i++)fontSrcChipData[i]=fontSourcesList[i],0!=fontSrcChipData[i].length&&srcChipConversion(fontSrcChipData,"font-src-chip-content","#txt-fontsrc");if(null!=imgSourcesList&&""!=imgSourcesList)for(i=0;i<imgSourcesList.length;i++)imgSrcChipData[i]=imgSourcesList[i],0!=imgSrcChipData[i].length&&srcChipConversion(imgSrcChipData,"img-src-chip-content","#txt-imgsrc");if(null!=connectSourcesList&&""!=connectSourcesList)for(i=0;i<connectSourcesList.length;i++)connectSrcChipData[i]=connectSourcesList[i],0!=connectSrcChipData[i].length&&srcChipConversion(connectSrcChipData,"connect-src-chip-content","#txt-connectsrc");if(null!=frameSourcesList&&""!=frameSourcesList)for(i=0;i<frameSourcesList.length;i++)frameSrcChipData[i]=frameSourcesList[i],0!=frameSrcChipData[i].length&&srcChipConversion(frameSrcChipData,"frame-src-chip-content","#txt-framesrc");$("#restrict-ipwhitelist-enabled").is(":checked")?($("#rulesgrid").show(),$(".whitelisting-info").show()):($("#rulesgrid").hide(),$(".whitelisting-info").hide()),disableOrEnableCSPSettingsForm(),initializeTabs();var t=window.location.search.toLowerCase();t.includes("x-frame-options")?($("#x-frame-options").addClass("active show").siblings(".tab-pane").removeClass("active show"),$("#x-frame-options-tab").parent().addClass("active").siblings().removeClass("active")):t.includes("network-settings")?($("#network-settings").addClass("active show").siblings(".tab-pane").removeClass("active show"),$("#network-settings-tab").parent().addClass("active").siblings().removeClass("active")):($("#csp-settings").addClass("active show").siblings(".tab-pane").removeClass("active show"),$("#csp-settings-tab").parent().addClass("active").siblings().removeClass("active"),window.location.href.includes("?")||history.replaceState(null,"","?tab=csp-settings"))}),$(document).on("click","#enable-csp",function(){disableOrEnableCSPSettingsForm()}),$(document).on("click","#x-frame",function(){$("#x-frame").is(":checked")?($("#x-frame-checkbox-label").css("padding-bottom","20px"),$(".x-frame-notification").show()):($(".x-frame-notification").hide(),$("#x-frame-checkbox-label").css("padding-bottom","32px"))}),$(document).on("keyup",".txt-input-src",function(t){var e=t.target.id;(1==$("#"+e).length&&$("#"+e).focus(),t.keyCode==keyCode.Comma||t.keyCode==keyCode.Enter)&&objectConvertAsSrcDirectiveChip($("#"+e).val(),e)}),$(document).on("keyup","#style-src-content",function(t){var e=document.getElementById("style-src-chip-content").ej2_instances;null==e||null!=e[0].chips&&0!=e[0].chips?null==e&&0==$("#txt-stylesrc").val().length&&applySrcContainer("#txt-stylesrc"):(""==$("#txt-stylesrc").val()&&applySrcContainer("#txt-stylesrc"),e[0].chips=[],setTimeout(function(){$("#style-src-chip-content").html("")},100)),setTimeout(function(){$("#style-src-chip-content .e-chip").hasClass("chip-validation")||""!=$("#txt-stylesrc").val()||$(".style-src-validation").html("")},100)}),$(document).on("keyup","#script-src-content",function(t){var e=document.getElementById("script-src-chip-content").ej2_instances;null==e||null!=e[0].chips&&0!=e[0].chips?null==e&&0==$("#txt-scriptsrc").val().length&&applySrcContainer("#txt-scriptsrc"):(""==$("#txt-scriptsrc").val()&&applySrcContainer("#txt-scriptsrc"),e[0].chips=[],setTimeout(function(){$("#script-src-chip-content").html("")},100)),setTimeout(function(){$("#script-src-chip-content .e-chip").hasClass("chip-validation")||""!=$("#txt-scriptsrc").val()||$(".script-src-validation").html("")},100)}),$(document).on("keyup","#font-src-content",function(t){var e=document.getElementById("font-src-chip-content").ej2_instances;null==e||null!=e[0].chips&&0!=e[0].chips?null==e&&0==$("#txt-fontsrc").val().length&&applySrcContainer("#txt-fontsrc"):(""==$("#txt-fontsrc").val()&&applySrcContainer("#txt-fontsrc"),e[0].chips=[],setTimeout(function(){$("#font-src-chip-content").html("")},100)),setTimeout(function(){$("#font-src-chip-content .e-chip").hasClass("chip-validation")||""!=$("#txt-fontsrc").val()||$(".font-src-validation").html("")},100)}),$(document).on("keyup","#img-src-content",function(t){var e=document.getElementById("img-src-chip-content").ej2_instances;null==e||null!=e[0].chips&&0!=e[0].chips?null==e&&0==$("#txt-imgsrc").val().length&&applySrcContainer("#txt-imgsrc"):(""==$("#txt-imgsrc").val()&&applySrcContainer("#txt-imgsrc"),e[0].chips=[],setTimeout(function(){$("#img-src-chip-content").html("")},100)),setTimeout(function(){$("#img-src-chip-content .e-chip").hasClass("chip-validation")||""!=$("#txt-imgsrc").val()||$(".img-src-validation").html("")},100)}),$(document).on("keyup","#connect-src-content",function(t){var e=document.getElementById("connect-src-chip-content").ej2_instances;null==e||null!=e[0].chips&&0!=e[0].chips?null==e&&0==$("#txt-connectsrc").val().length&&applySrcContainer("#txt-connectsrc"):(""==$("#txt-connectsrc").val()&&applySrcContainer("#txt-connectsrc"),e[0].chips=[],setTimeout(function(){$("#connect-src-chip-content").html("")},100)),setTimeout(function(){$("#connect-src-chip-content .e-chip").hasClass("chip-validation")||""!=$("#txt-connectsrc").val()||$(".connect-src-validation").html("")},100)}),$(document).on("keyup","#frame-src-content",function(t){var e=document.getElementById("frame-src-chip-content").ej2_instances;null==e||null!=e[0].chips&&0!=e[0].chips?null==e&&0==$("#txt-framesrc").val().length&&applySrcContainer("#txt-framesrc"):(""==$("#txt-framesrc").val()&&applySrcContainer("#txt-framesrc"),e[0].chips=[],setTimeout(function(){$("#frame-src-chip-content").html("")},100)),setTimeout(function(){$("#frame-src-chip-content .e-chip").hasClass("chip-validation")||""!=$("#txt-framesrc").val()||$(".frame-src-validation").html("")},100)}),$(document).on("focusin",".txt-input-src",function(t){"txt-stylesrc"==t.target.id?$("#style-src-content").addClass("focused"):"txt-scriptsrc"==t.target.id?$("#script-src-content").addClass("focused"):"txt-fontsrc"==t.target.id?$("#font-src-content").addClass("focused"):"txt-imgsrc"==t.target.id?$("#img-src-content").addClass("focused"):"txt-connectsrc"==t.target.id?$("#connect-src-content").addClass("focused"):"txt-framesrc"==t.target.id&&$("#frame-src-content").addClass("focused")}),$(".txt-input-src").focusout(function(t){var e=t.target.id;if("txt-stylesrc"==e){var c=$("#txt-stylesrc").val()+",";c.length>1&&objectConvertAsSrcDirectiveChip(c,e),$("#style-src-content").removeClass("focused")}else if("txt-scriptsrc"==e){var n=$("#txt-scriptsrc").val()+",";n.length>1&&objectConvertAsSrcDirectiveChip(n,e),$("#script-src-content").removeClass("focused")}else if("txt-fontsrc"==e){var i=$("#txt-fontsrc").val()+",";i.length>1&&objectConvertAsSrcDirectiveChip(i,e),$("#font-src-content").removeClass("focused")}else if("txt-imgsrc"==e){var s=$("#txt-imgsrc").val()+",";s.length>1&&objectConvertAsSrcDirectiveChip(s,e),$("#img-src-content").removeClass("focused")}else if("txt-connectsrc"==e){var r=$("#txt-connectsrc").val()+",";r.length>1&&objectConvertAsSrcDirectiveChip(r,e),$("#connect-src-content").removeClass("focused")}else if("txt-framesrc"==e){var o=$("#txt-framesrc").val()+",";o.length>1&&objectConvertAsSrcDirectiveChip(o,e),$("#frame-src-content").removeClass("focused")}}),$(document).on("click",".src-input-class",function(t){"style-src-content"!=t.target.id||$(t.target).hasClass("e-chip")||$(t.target).hasClass("e-chip-text")?"script-src-content"!=t.target.id||$(t.target).hasClass("e-chip")||$(t.target).hasClass("e-chip-text")?"font-src-content"!=t.target.id||$(t.target).hasClass("e-chip")||$(t.target).hasClass("e-chip-text")?"img-src-content"!=t.target.id||$(t.target).hasClass("e-chip")||$(t.target).hasClass("e-chip-text")?"connect-src-content"!=t.target.id||$(t.target).hasClass("e-chip")||$(t.target).hasClass("e-chip-text")?"frame-src-content"!=t.target.id||$(t.target).hasClass("e-chip")||$(t.target).hasClass("e-chip-text")||$("#txt-framesrc").focus():$("#txt-connectsrc").focus():$("#txt-imgsrc").focus():$("#txt-fontsrc").focus():$("#txt-scriptsrc").focus():$("#txt-stylesrc").focus()}),$(document).on("keypress",".txt-input-src",function(t){var e=8*($("#"+t.target.id).val().length+1);$("#"+t.target.id).css("width",e+"px")}),$(document).on("keydown","#style-src-content",function(t){if(t.keyCode==keyCode.BackSpace&&0==$("#txt-stylesrc").val().length){isChrome&&isEdge||t.preventDefault();var e=document.getElementById("style-src-chip-content").ej2_instances;null!=e&&0!=e[0].chips&&null!=e[0].chips&&($("#style-src-chip-content > .e-chip:last").hasClass("e-focused")?(e[0].chips.pop(),e[0].chips.length>0&&e[0].refresh(),applySrcTooltip("style-src-chip-content"),checkSrcValidation("style-src-chip-content"),$(".style-src-validation").html(""),$("#txt-stylesrc").focus()):($("#style-src-chip-content > .e-chip:last").addClass("e-focused"),$("#style-src-chip-content > .e-chip:last").focus()),null!=e[0].chips&&0!=e[0].chips.length||getSrcInstance("style-src-chip-content"))}}),$(document).on("keydown","#script-src-content",function(t){if(t.keyCode==keyCode.BackSpace&&0==$("#txt-scriptsrc").val().length){isChrome&&isEdge||t.preventDefault();var e=document.getElementById("script-src-chip-content").ej2_instances;null!=e&&0!=e[0].chips&&null!=e[0].chips&&($("#script-src-chip-content > .e-chip:last").hasClass("e-focused")?(e[0].chips.pop(),e[0].chips.length>0&&e[0].refresh(),applySrcTooltip("script-src-chip-content"),checkSrcValidation("script-src-chip-content"),$(".script-src-validation").html(""),$("#txt-scriptsrc").focus()):($("#script-src-chip-content > .e-chip:last").addClass("e-focused"),$("#script-src-chip-content > .e-chip:last").focus()),null!=e[0].chips&&0!=e[0].chips.length||getSrcInstance("script-src-chip-content"))}}),$(document).on("keydown","#font-src-content",function(t){if(t.keyCode==keyCode.BackSpace&&0==$("#txt-fontsrc").val().length){isChrome&&isEdge||t.preventDefault();var e=document.getElementById("font-src-chip-content").ej2_instances;null!=e&&0!=e[0].chips&&null!=e[0].chips&&($("#font-src-chip-content > .e-chip:last").hasClass("e-focused")?(e[0].chips.pop(),e[0].chips.length>0&&e[0].refresh(),applySrcTooltip("font-src-chip-content"),checkSrcValidation("font-src-chip-content"),$(".font-src-validation").html(""),$("#txt-fontsrc").focus()):($("#font-src-chip-content > .e-chip:last").addClass("e-focused"),$("#font-src-chip-content > .e-chip:last").focus()),null!=e[0].chips&&0!=e[0].chips.length||getSrcInstance("font-src-chip-content"))}}),$(document).on("keydown","#img-src-content",function(t){if(t.keyCode==keyCode.BackSpace&&0==$("#txt-imgsrc").val().length){isChrome&&isEdge||t.preventDefault();var e=document.getElementById("img-src-chip-content").ej2_instances;null!=e&&0!=e[0].chips&&null!=e[0].chips&&($("#img-src-chip-content > .e-chip:last").hasClass("e-focused")?(e[0].chips.pop(),e[0].chips.length>0&&e[0].refresh(),applySrcTooltip("img-src-chip-content"),checkSrcValidation("img-src-chip-content"),$(".img-src-validation").html(""),$("#txt-imgsrc").focus()):($("#img-src-chip-content > .e-chip:last").addClass("e-focused"),$("#img-src-chip-content > .e-chip:last").focus()),null!=e[0].chips&&0!=e[0].chips.length||getSrcInstance("img-src-chip-content"))}}),$(document).on("keydown","#connect-src-content",function(t){if(t.keyCode==keyCode.BackSpace&&0==$("#txt-connectsrc").val().length){isChrome&&isEdge||t.preventDefault();var e=document.getElementById("connect-src-chip-content").ej2_instances;null!=e&&0!=e[0].chips&&null!=e[0].chips&&($("#connect-src-chip-content > .e-chip:last").hasClass("e-focused")?(e[0].chips.pop(),e[0].chips.length>0&&e[0].refresh(),applySrcTooltip("connect-src-chip-content"),checkSrcValidation("connect-src-chip-content"),$(".connect-src-validation").html(""),$("#txt-connectsrc").focus()):($("#connect-src-chip-content > .e-chip:last").addClass("e-focused"),$("#connect-src-chip-content > .e-chip:last").focus()),null!=e[0].chips&&0!=e[0].chips.length||getSrcInstance("connect-src-chip-content"))}}),$(document).on("keydown","#frame-src-content",function(t){if(t.keyCode==keyCode.BackSpace&&0==$("#txt-framesrc").val().length){isChrome&&isEdge||t.preventDefault();var e=document.getElementById("frame-src-chip-content").ej2_instances;null!=e&&0!=e[0].chips&&null!=e[0].chips&&($("#frame-src-chip-content > .e-chip:last").hasClass("e-focused")?(e[0].chips.pop(),e[0].chips.length>0&&e[0].refresh(),applySrcTooltip("frame-src-chip-content"),checkSrcValidation("frame-src-chip-content"),$(".frame-src-validation").html(""),$("#txt-framesrc").focus()):($("#frame-src-chip-content > .e-chip:last").addClass("e-focused"),$("#frame-src-chip-content > .e-chip:last").focus()),null!=e[0].chips&&0!=e[0].chips.length||getSrcInstance("frame-src-chip-content"))}}),$(document).on("paste","#txt-stylesrc",function(t){var e=t.originalEvent.clipboardData.getData("Text").trim().split(/[\s,;\r?\n]+/);if(e.length>1){for(var c=0;c<e.length;c++){var n=e[c];isSrcChipAlreadyExists(n,"style-src-chip-content")&&""!=n&&(styleSrcChipData.push(n),srcChipConversion(styleSrcChipData,"style-src-chip-content","#txt-stylesrc"))}setTimeout(function(){$("#txt-stylesrc").val("")},100)}}),$(document).on("paste","#txt-scriptsrc",function(t){var e=t.originalEvent.clipboardData.getData("Text").trim().split(/[\s,;\r?\n]+/);if(e.length>1){for(var c=0;c<e.length;c++){var n=e[c];isSrcChipAlreadyExists(n,"script-src-chip-content")&&""!=n&&(scriptSrcChipData.push(n),srcChipConversion(scriptSrcChipData,"script-src-chip-content","#txt-scriptsrc"))}setTimeout(function(){$("#txt-scriptsrc").val("")},100)}}),$(document).on("paste","#txt-fontsrc",function(t){var e=t.originalEvent.clipboardData.getData("Text").trim().split(/[\s,;\r?\n]+/);if(e.length>1){for(var c=0;c<e.length;c++){var n=e[c];isSrcChipAlreadyExists(n,"font-src-chip-content")&&""!=n&&(fontSrcChipData.push(n),srcChipConversion(fontSrcChipData,"font-src-chip-content","#txt-fontsrc"))}setTimeout(function(){$("#txt-fontsrc").val("")},100)}}),$(document).on("paste","#txt-imgsrc",function(t){var e=t.originalEvent.clipboardData.getData("Text").trim().split(/[\s,;\r?\n]+/);if(e.length>1){for(var c=0;c<e.length;c++){var n=e[c];isSrcChipAlreadyExists(n,"img-src-chip-content")&&""!=n&&(imgSrcChipData.push(n),srcChipConversion(imgSrcChipData,"img-src-chip-content","#txt-imgsrc"))}setTimeout(function(){$("#txt-imgsrc").val("")},100)}}),$(document).on("paste","#txt-connectsrc",function(t){var e=t.originalEvent.clipboardData.getData("Text").trim().split(/[\s,;\r?\n]+/);if(e.length>1){for(var c=0;c<e.length;c++){var n=e[c];isSrcChipAlreadyExists(n,"connect-src-chip-content")&&""!=n&&(connectSrcChipData.push(n),srcChipConversion(connectSrcChipData,"connect-src-chip-content","#txt-connectsrc"))}setTimeout(function(){$("#txt-connectsrc").val("")},100)}}),$(document).on("paste","#txt-framesrc",function(t){var e=t.originalEvent.clipboardData.getData("Text").trim().split(/[\s,;\r?\n]+/);if(e.length>1){for(var c=0;c<e.length;c++){var n=e[c];isSrcChipAlreadyExists(n,"frame-src-chip-content")&&""!=n&&(frameSrcChipData.push(n),srcChipConversion(frameSrcChipData,"frame-src-chip-content","#txt-framesrc"))}setTimeout(function(){$("#txt-framesrc").val("")},100)}}),$(document).on("click","#update-csp-settings",function(){var t="",e=[],c=[],n=[],i=[],s=[],r=[];if(""==$(".style-src-validation").text()&&""==$(".script-src-validation").text()&&""==$(".font-src-validation").text()&&""==$(".img-src-validation").text()&&""==$(".connect-src-validation").text()&&""==$(".frame-src-validation").text()){var o=document.getElementById("style-src-chip-content").ej2_instances;null!=o&&null==(e=o[0].chips)&&(e=[]);var a=document.getElementById("script-src-chip-content").ej2_instances;null!=a&&null==(c=a[0].chips)&&(c=[]);var l=document.getElementById("font-src-chip-content").ej2_instances;null!=l&&null==(n=l[0].chips)&&(n=[]);var p=document.getElementById("img-src-chip-content").ej2_instances;null!=p&&null==(i=p[0].chips)&&(i=[]);var h=document.getElementById("connect-src-chip-content").ej2_instances;null!=h&&null==(s=h[0].chips)&&(s=[]);var d=document.getElementById("frame-src-chip-content").ej2_instances;null!=d&&null==(r=d[0].chips)&&(r=[]),t=$("#enable-csp").is(":checked")?{IsCSPEnabled:$("#enable-csp").is(":checked"),StyleSource:e.toString(),ScriptSource:c.toString(),FontSource:n.toString(),ImageSource:i.toString(),ConnectSource:s.toString(),FrameSource:r.toString()}:{IsCSPEnabled:!1};var u={SettingsKey:SettingsScopes.Security,ContentSecurityPolicy:t};$.ajax({type:"POST",url:updateCSPSettingsUrl,data:{systemSettingsData:JSON.stringify(u)},beforeSend:showWaitingPopup($("#server-app-container")),success:function(t){t.status?SuccessAlert(window.Server.App.LocalizationContent.SecuritySettings,window.Server.App.LocalizationContent.SettingsSuccessAlert,7e3):(WarningAlert(window.Server.App.LocalizationContent.SecuritySettings,null!=t.permissionDenied&&t.permissionDenied?window.Server.App.LocalizationContent.PermissionWarningAlert:window.Server.App.LocalizationContent.SettingsWarningAlert,7e3),$(".error-message, .success-message").css("display","none")),hideWaitingPopup($("#server-app-container"))}})}}),$(document).on("click","#update-x-frame-options-settings",function(){var t=$("#x-frame").is(":checked");$.ajax({type:"POST",url:updateXFrameHeaderSettingsUrl,data:{systemSettingValue:t,key:"IsXFrameOptionsEnabled"},beforeSend:showWaitingPopup($("#server-app-container")),success:function(t){t.status?SuccessAlert(window.Server.App.LocalizationContent.SecuritySettings,window.Server.App.LocalizationContent.SettingsSuccessAlert,7e3):(WarningAlert(window.Server.App.LocalizationContent.SecuritySettings,null!=t.permissionDenied&&t.permissionDenied?window.Server.App.LocalizationContent.PermissionWarningAlert:window.Server.App.LocalizationContent.SettingsWarningAlert,7e3),$(".error-message, .success-message").css("display","none")),hideWaitingPopup($("#server-app-container"))}})}),$(document).on("click","#update-network-settings",function(){var t=$("#restrict-ipwhitelist-enabled").is(":checked"),e=dataSourceRule.some(function(t){return t.IPAddress===currentUserIP}),c={IsEnabled:t,IPWhitelistingRules:dataSourceRule};if(t){if(!dataSourceRule||0===dataSourceRule.length)return void WarningAlert("",window.Server.App.LocalizationContent.IpAddressSettingsFailed,7e3);if(!e)return void WarningAlert("",window.Server.App.LocalizationContent.CurrentUserIpAddress,7e3)}$.ajax({type:"POST",url:updateNetworkSettingsUrl,data:{networksetting:JSON.stringify(c)},beforeSend:showWaitingPopup($("#server-app-container")),success:function(t){hideWaitingPopup($("#server-app-container")),t.status?SuccessAlert(window.Server.App.LocalizationContent.SecuritySettings,window.Server.App.LocalizationContent.SettingsSuccessAlert,7e3):WarningAlert(window.Server.App.LocalizationContent.SecuritySettings,window.Server.App.LocalizationContent.SettingsWarningAlert,7e3)}})}),$(document).on("click","#restrict-ipwhitelist-enabled",function(){$(this).is(":checked")?($("#rulesgrid").show(),$(".whitelisting-info").show()):($("#rulesgrid").hide(),$(".whitelisting-info").hide())}),$(document).on("click","input#add-rule",function(){if(isEditing){var t=$.trim($("#rulename").val()),e=$.trim($("#ipaddress").val()),c=$('input[name="ipaddress-type"]:checked').val();if($("#dialog-container").valid()){$(".ruleadd-validation-messages").css("display","none");var n={RuleName:t,IPAddress:e,IPAddressType:c},i=dataSourceRule.filter(function(t){return t.RuleName!==exisitingRuleName});i.unshift(n),dataSourceRule=i,exisitingRuleName=null,existsIpAddress=null,(s=$("#rulesgrid").data("ejGrid")).dataSource(dataSourceRule),s.refreshContent(),onRuleAddDialogClose()}else $(".ruleadd-validation-messages").css("display","block")}else{t=$.trim($("#rulename").val()),e=$.trim($("#ipaddress").val()),c=$('input[name="ipaddress-type"]:checked').val();if($("#dialog-container").valid()){$(".ruleadd-validation-messages").css("display","none");var s,r={RuleName:t,IPAddress:e,IPAddressType:c};dataSourceRule.unshift(r),(s=$("#rulesgrid").data("ejGrid")).dataSource(dataSourceRule),s.refreshContent(),onRuleAddDialogClose()}else $(".ruleadd-validation-messages").css("display","block")}}),$(document).on("change",'input[name="ipaddress-type"]',function(){$("#dialog-container").validate().element("#ipaddress")}),$(document).on("click",'.tenant-action[data-action="delete"]',function(){var t=$(this).data("rule-name").toString(),e=($(this).data("ipaddress"),$(this).data("ip-type"),dataSourceRule.filter(function(e){return e.RuleName!==t}));dataSourceRule=e;var c=$("#rulesgrid").data("ejGrid");c.dataSource(dataSourceRule),c.refreshContent()}),$(document).on("click",'.tenant-action[data-action="edit"]',function(){isEditing=!0,exisitingRuleName=$(this).data("rule-name").toString(),existsIpAddress=$(this).data("ipaddress");var t=$(this).data("ip-type");$("#rulename").val(exisitingRuleName),$("#ipaddress").val(existsIpAddress),$('input[name="ipaddress-type"][value="'+t+'"]').prop("checked",!0),onRuleAddDialogOpen()}),$.ajaxSetup({beforeSend:function(t){setXSRFRequestHeader(t)}});
