var autoCompleteControlEle="",autoCompleteControlWrapperEle="",autoCompleteHiddenEle="",query="",autoCompleteInstance="",autocompleteInputSearchWrapperObj="",suggestionListWrapperObj="",dataManagerObj=null,userEmailList=[],groupIdList=[];function getSuggestionForItem(e){$.xhrPool.abortAll();var t=autoCompleteHiddenEle.attr("data-item-id");""!=e.trim()&&$.ajax({type:"get",url:shareItemSuggestionListUrl,data:{searchWord:e,itemId:t},contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){autoCompleteInstance.model.dataSource=e,autoCompleteInstance._OnTextEnter()}})}function onChange(e){autoCompleteHiddenEle.attr("data-itemtype")!=ItemType.UserManagement?""!=e.value&&""!=autoCompleteInstance.getValue()?(shareBtnObj.show(),manageAccessCancelBtnObj.show(),manageAccessSaveBtnObj.hide(),shareDoneBtnObj.hide(),manageUserGroupContainer.addClass("disable-element-opacity")):(shareBtnObj.hide(),manageAccessSaveBtnObj.hide(),manageAccessCancelBtnObj.hide(),shareDoneBtnObj.show(),manageUserGroupContainer.removeClass("disable-element-opacity")):""!=e.value&&""!=autoCompleteInstance.getValue()?(addOwnerBtnObj.show(),manageAccessCancelBtnObj.show(),manageAccessSaveBtnObj.hide(),shareDoneBtnObj.hide(),manageUserGroupContainer.addClass("disable-element-opacity")):(addOwnerBtnObj.hide(),manageAccessSaveBtnObj.hide(),manageAccessCancelBtnObj.hide(),shareDoneBtnObj.show(),manageUserGroupContainer.removeClass("disable-element-opacity"))}function splitUserGroupList(){userEmailList=[],groupIdList=[];var e=getSelectedItems();$.each(e,function(e,t){isNaN(t.Value)&&"user"==t.Type?userEmailList.push(t.Value):groupIdList.push(t.Value)})}function refreshAutoComplete(){autoCompleteControlEle.ejAutocomplete("clearText")}function getSelectedItems(){return autoCompleteControlEle.ejAutocomplete("getSelectedItems")}function enableAutomCompleteControl(){refreshAutoComplete(),autoCompleteControlEle.ejAutocomplete("enable"),autoCompleteControlWrapperEle.find(".e-in-wrap.e-box.e-corner").removeClass("disable-autocomplete")}function disableAutomCompleteControl(){refreshAutoComplete(),autoCompleteControlEle.ejAutocomplete("disable"),autoCompleteControlWrapperEle.find(".e-in-wrap.e-box.e-corner").addClass("disable-autocomplete")}function getUserGroupProfilePicture(e,t,o,a){return"<div class='col-2 no-padding search-user-group-img-container'><div class='group-logo'><i class='su su-"+o+"'></i></div></div><div class='col-9 no-padding search-user-group-display-name-container'><div class='search-user-group-display-name'><span>"+e+"</span></div></div>"}function insertLoaderIcon(){autoCompleteControlWrapperEle.prepend("<div class='auto-complete-search-loader'></div>")}function removeLoaderIcon(){autoCompleteControlWrapperEle.find(".auto-complete-search-loader").remove()}function suggestionListSelection(){$("#user-group-search-input_suggestion li").each(function(){$(this).addClass("d-flex align-items-center")})}function extractXSRFTokenFromCookie(){var e=parent.document.cookie.split("; ").find(e=>e.startsWith("XSRF-TOKEN="));return e?e.split("=")[1]:null}function setXSRFRequestHeader(e){e.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())}function decodeHtmlAsString(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}function EscapeHtml(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}$(function(){autoCompleteControlEle=$("#user-group-search-input"),autoCompleteHiddenEle=$("#user-group-search-hidden-input"),dataManagerObj=ej.DataManager({url:shareItemSuggestionListUrl}),query=ej.Query().from("userMentionList").select("Name","Value"),autoCompleteControlEle.ejAutocomplete({dataSource:dataManagerObj,query:query,fields:{text:"Name",key:"Value"},filterType:ej.filterType.StartsWith,watermarkText:"John Doe, Sales Team",width:"100%",multiSelectMode:ej.MultiSelectMode.VisualMode,showPopupButton:!1,showEmptyResultText:!0,emptyResultText:window.Server.App.LocalizationContent.NoUserorGroup,showRoundedCorner:!0,popupHeight:"120px",change:"onChange",open:"onSuggestionListOpen",close:"onSuggestionListClose",showLoadingIcon:!1,actionBegin:function(e){insertLoaderIcon(),splitUserGroupList(),e.model.query._params=[],e.model.query._params.push({key:"searchWord",value:autoCompleteInstance._preVal}),e.model.query._params.push({key:"UserEmailList",value:userEmailList}),e.model.query._params.push({key:"GroupIdList",value:groupIdList})},actionComplete:function(e){removeLoaderIcon(),suggestionListSelection()},template:getUserGroupProfilePicture("${Name}","${Value}","${Type}","${IdPReferenceId}")}),autoCompleteInstance=autoCompleteControlEle.data("ejAutocomplete"),autoCompleteControlWrapperEle=$("#user-group-search-input_wrapper"),autocompleteInputSearchWrapperObj=$(".e-in-wrap.e-box.e-corner");(suggestionListWrapperObj=$("#user-group-search-input_suggestion")).ejScroller({height:120,width:"20%",scrollerSize:7,buttonSize:0,enableTouchScroll:!0});var e=suggestionListWrapperObj.ejScroller("instance");e.model.height=120,e.refresh(),$("#user-group-search-input_suggestion .e-scrollbar").show()}),$.ajaxSetup({beforeSend:function(e){setXSRFRequestHeader(e)}});
