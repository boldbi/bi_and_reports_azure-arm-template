function getAllStaticData(){void 0===window.userList&&$.ajax({type:"POST",url:getActiveandInactiveUserUrl,data:{},async:!1,success:function(e){window.userList=e.data.users,window.groupList=e.data.groups}}),$("#user-search").append(window.userList),$("#group-search").append(window.groupList),$("#pdf-export").prop("checked",!0),$(".selectpicker").selectpicker("destroy"),$(".selectpicker").selectpicker(),$("#schedule-submit").attr("data-report-id",createdItemId),$("#schedule-submit").attr("data-item-id",createdItemId),$("#user-search-container .bs-deselect-all").after("<div class='bs-select-all-custom'><span>"+window.Server.App.LocalizationContent.Select+"</span><span class='bs-select-custom-tick glyphicon glyphicon-ok' ></span></div>"),$("#group-search-container .bs-deselect-all").after("<div class='bs-select-all-custom'><span>"+window.Server.App.LocalizationContent.Select+"</span><span class='bs-select-custom-tick glyphicon glyphicon-ok' ></span></div>")}function toggleReplyToBlock(){const e=$(".reply-to-send-mail-block");$("#enable-send-mail").is(":checked")?e.removeClass("d-none"):(e.addClass("d-none"),$("#reply-to-email").val(""),$("#reply-to-email-validation").text(""))}function validateExternalRecipient(){$(document).on("keypress","#external-email",function(e){13===e.which&&(e.preventDefault(),$("#external-submit").click())}),$(document).on("click","#external-submit",function(e){var t=$("#external-email").val().toLowerCase().split(","),a=[];for(o=0;o<t.length;o++)-1===a.indexOf(t[o])&&""!==t[o]&&a.push(t[o]);t=a;for(var s=$(".selected-recipients").children(),n=0;n<t.length;n++)if(IsEmail(t[n])){var r=$("<div>").attr("id",t[n]).attr("data-searchtype","externalRecipient").addClass("SelectedShareItems");r.html("<div class='InstantSearch'><span class='details' title='"+t[n]+"'>"+t[n]+"</span><div style='width:auto' class='instant-cancel'><span class='su su-close i-selected-cancel'/></div></div>");for(var o=0;o<s.length;o++)if("externalRecipient"===s[o].getAttribute("data-searchtype")&&t[n]===s[o].id)return $("#external-email").addClass("inactive-box"),$("#external-submit").addClass("inactive-icon"),void $("#external-email-validation").html("<span class='validate-fail'>"+window.Server.App.LocalizationContent.IsMailExist+"</span>");$("#selected-users").append(r),$("#external-email").val(""),$("#selected-users-validation").css("visibility","hidden"),selectedItemsCount()}else""!==t[n]?($("#external-email").addClass("inactive-box"),$("#external-submit").addClass("inactive-icon"),$("#external-email-validation").html("<span class='validate-fail'>"+window.Server.App.LocalizationContent.IsValidEmail+"</span>")):($("#external-email").removeClass("inactive-box"),$("#external-submit").removeClass("inactive-icon"),$("#external-email-validation").html())}),$(document).on("keyup","#external-email",function(e){13!==e.keyCode&&($("#external-email").removeClass("inactive-box"),$("#external-submit").removeClass("inactive-icon"),$("#external-email-validation").html(""))})}function validateReplyToEmail(){const e=$("#reply-to-email"),t=$(".reply-to-email-validation"),a=$.trim(e.val());return e.removeClass("inactive-box"),t.empty().removeClass("d-none"),""===a||(!!IsEmail(a)||(e.addClass("inactive-box"),t.html("<span class='validate-fail'>"+window.Server.App.LocalizationContent.IsValidEmail+"</span>"),!1))}function selectedItemsCount(){$("#selected-users-info").html("<span class='float-start'>"+$(".SelectedShareItems[data-searchtype='userSearch']").length+" "+window.Server.App.LocalizationContent.Users+" "+$(".SelectedShareItems[data-searchtype='groupSearch']").length+" "+window.Server.App.LocalizationContent.Groups+" "+$(".SelectedShareItems[data-searchtype='externalRecipient']").length+" "+window.Server.App.LocalizationContent.ExternalRecipients+"<span>").css({"padding-top":"10px","padding-left":"15px","margin-top":"0"})}function validateSubscriber(){if(!$("#selected-users").children().length>0)return $("#selectedRecipientErrorContainer").css("display","block"),$("#selectedRecipientValidator").html(window.Server.App.LocalizationContent.AtleastOneRecipient),!1;$("#selectedRecipientErrorContainer").css("display","none")}function FTPCredentialsValidation(){""==$("#ftp-host-name").val()&&($("#ftp-host-name").closest("div").addClass("has-error"),$("#ftp-validation").css("display","none"),$("#ftp-hostname-validation").html(window.Server.App.LocalizationContent.HostNamevalidator).css("display","block").css({color:"#a94442","font-size":"12px"})),""==$("#ftp-user-name").val()&&($("#ftp-user-name").closest("div").addClass("has-error"),$("#ftp-validation").css("display","none"),$("#ftp-username-validation").html(window.Server.App.LocalizationContent.UserNameValidator).css("display","block").css({color:"#a94442","font-size":"12px"})),""==$("#ftp-password").val()&&($("#ftp-password").closest("div").addClass("has-error"),$("#ftp-validation").css("display","none"),$("#ftp-password-validation").html(window.Server.App.LocalizationContent.EnterPassword).css("display","block").css({color:"#a94442","font-size":"12px"}))}function S3BucketCredentialsValidation(){""==$("#s3-access-key").val()&&($("#s3-access-key").closest("div").addClass("has-error"),$("#s3-bucket-validation").css("display","none"),$("#s3-accesskey-validation").html(window.Server.App.LocalizationContent.S3AccessKeyValidator).css("display","block").css({color:"#a94442","font-size":"12px"})),""==$("#s3-bucket-name").val()&&($("#s3-bucket-name").closest("div").addClass("has-error"),$("#s3-bucket-validation").css("display","none"),$("#s3-bucketname-validation").html(window.Server.App.LocalizationContent.S3BucketNameValidator).css("display","block").css({color:"#a94442","font-size":"12px"})),""==$("#s3-region").val()&&($("#s3-region").closest("div").addClass("has-error"),$("#s3-bucket-validation").css("display","none"),$("#s3-region-validation").html(window.Server.App.LocalizationContent.S3RegionValidator).css("display","block").css({color:"#a94442","font-size":"12px"})),""==$("#s3-secretkey").val()&&($("#s3-secretkey").closest("div").addClass("has-error"),$("#s3-bucket-validation").css("display","none"),$("#s3-secretkey-validation").html(window.Server.App.LocalizationContent.S3SecretKeyValidator).css("display","block").css({color:"#a94442","font-size":"12px"}))}function extractXSRFTokenFromCookie(){var e=document.cookie.split("; ").find(e=>e.startsWith("XSRF-TOKEN="));return e?e.split("=")[1]:null}function setXSRFRequestHeader(e){e.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())}function decodeHtmlAsString(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}function EscapeHtml(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}$(document).on("change","#enable-send-mail",toggleReplyToBlock),$(document).on("click","#user-search-container .bs-select-all-custom",function(e){$("#user-search-container").addClass("value-changed"),$("#user-search").data("selectpicker").selectAll(),$(this).removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom"),$($(this).children("span")[0]).text(window.Server.App.LocalizationContent.Clear),selectedItemsCount(),e.stopPropagation()}),$(document).on("click","#group-search-container .bs-select-all-custom",function(e){$("#group-search-container").addClass("value-changed"),$("#group-search").data("selectpicker").selectAll(),$(this).removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom"),$($(this).children("span")[0]).text(window.Server.App.LocalizationContent.Clear),selectedItemsCount(),e.stopPropagation()}),$(document).on("click","#user-search-container .bs-deselect-all-custom",function(e){$("#user-search-container").addClass("value-changed"),$("#user-search").data("selectpicker").deselectAll(),$(this).removeClass("bs-deselect-all-custom").addClass("bs-select-all-custom"),$($(this).children("span")[0]).text(window.Server.App.LocalizationContent.Select),$(".SelectedShareItems[data-searchtype='userSearch']").remove(),selectedItemsCount(),e.stopPropagation()}),$(document).on("click","#group-search-container .bs-deselect-all-custom",function(e){$("#group-search-container").addClass("value-changed"),$("#group-search").data("selectpicker").deselectAll(),$(this).removeClass("bs-deselect-all-custom").addClass("bs-select-all-custom"),$($(this).children("span")[0]).text(window.Server.App.LocalizationContent.Select),$(".SelectedShareItems[data-searchtype='groupSearch']").remove(),selectedItemsCount(),e.stopPropagation()}),$(document).on("changed.bs.select","#user-search",function(e){$("#user-search-container").addClass("value-changed");var t=$("#user-search-container .bootstrap-select li.selected").length,a=$("#user-search-container .bootstrap-select li").length;t>0&&$("#selected-users-validation").css("visibility","hidden"),t===a&&($($("#user-search-container div.bs-select-all-custom").children("span")[0]).text(window.Server.App.LocalizationContent.Clear),$("#user-search-container div.bs-select-all-custom").removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom"));var s=$("#user-search option:selected"),n=s.map(function(){return $(this).val()}).get();s.each(function(){var e=$(this).val(),t=$(this).text();if(0===$("#selected-users #"+CSS.escape(e)).length){var a=$("<div>").attr("id",e).attr("data-searchtype","userSearch").addClass("SelectedShareItems");a.html("<div class='InstantSearch'><span class='details' title='"+t+"'>"+t+"</span><div style='width:auto' class='instant-cancel'><span class='su su-close i-selected-cancel'></span></div></div>"),$("#selected-users").append(a)}}),$("#selected-users .SelectedShareItems").each(function(){var e=$(this).attr("id");n.includes(e)||$(this).remove()}),$(this).parent().addClass("active"),selectedItemsCount(),e.stopPropagation()}),$(document).on("changed.bs.select","#group-search",function(e){$("#group-search-container").addClass("value-changed");var t=$("#group-search-container .bootstrap-select li.selected").length,a=$("#group-search-container .bootstrap-select li").length;t>0&&$("#selected-users-validation").css("visibility","hidden"),t===a&&($($("#group-search-container div.bs-select-all-custom").children("span")[0]).text(window.Server.App.LocalizationContent.Clear),$("#group-search-container div.bs-select-all-custom").removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom"));var s=$("#group-search option:selected"),n=s.map(function(){return $(this).val()}).get();s.each(function(){var e=$(this).val(),t=$(this).text();if(0===$("#selected-users #"+CSS.escape(e)).length){var a=$("<div>").attr("id",e).attr("data-searchtype","groupSearch").addClass("SelectedShareItems");a.html("<div class='InstantSearch'><span class='details' title='"+t+"'>"+t+"</span><div style='width:auto' class='instant-cancel'><span class='su su-close i-selected-cancel'></span></div></div>"),$("#selected-users").append(a)}}),$("#selected-users .SelectedShareItems[data-searchtype='groupSearch']").each(function(){var e=$(this).attr("id");n.includes(e)||$(this).remove()}),$(this).parent().addClass("active"),selectedItemsCount(),e.stopPropagation()}),$(document).on("click","#subscribers-panel .i-selected-cancel",function(e){var t=$(this).closest(".SelectedShareItems"),a=t.attr("id"),s=t.attr("data-searchtype");"userSearch"===s?($("#user-search option[value='"+a+"']").prop("selected",!1),$("#user-search").selectpicker?.("destroy"),$("#user-search").selectpicker?.(),$("#user-search-container .bs-select-all-custom, #user-search-container .bs-deselect-all-custom").remove(),$("#user-search-container .bs-deselect-all").after("<div class='bs-select-all-custom'><span>"+window.Server.App.LocalizationContent.Select+"</span><span class='bs-select-custom-tick glyphicon glyphicon-ok'></span></div>"),t.remove()):"groupSearch"===s?($("#group-search option[value='"+a+"']").prop("selected",!1),$("#group-search").selectpicker?.("destroy"),$("#group-search").selectpicker?.(),$("#group-search-container .bs-select-all-custom, #group-search-container .bs-deselect-all-custom").remove(),$("#group-search-container .bs-deselect-all").after("<div class='bs-select-all-custom'><span>"+window.Server.App.LocalizationContent.Select+"</span><span class='bs-select-custom-tick glyphicon glyphicon-ok'></span></div>"),t.remove()):"externalRecipient"===s&&$(".SelectedShareItems[id='"+a+"']").remove(),selectedItemsCount()}),$(document).on("hide.bs.dropdown","#user-search-container",function(e){$("#user-search-container").hasClass("value-changed")&&($("#user-search-container").removeClass("value-changed"),e.stopPropagation())}),$(document).on("hide.bs.dropdown","#group-search-container",function(e){$("#group-search-container").hasClass("value-changed")&&($("#group-search-container").removeClass("value-changed"),e.stopPropagation())}),$(document).on("show.bs.dropdown","#user-search-container",function(e){$("#user-search").next("div").find(".dropdown-menu").addClass("dropdown-width");for(var t=0;t<$("#user-search option").length;t++)"false"==$("#user-search option").eq(t).attr("data-show").toLowerCase()&&($("#user-search-container .dropdown-menu .inner li").eq(t).addClass("disabled user-disabled"),$("#user-search-container .dropdown-menu .inner li").eq(t).attr("data-bs-toggle","tooltip").attr("data-bs-placement","right").attr("data-original-title",window.Server.App.LocalizationContent.AutoGeneratedMail)),$('[data-bs-toggle="tooltip"]').tooltip()}),$(document).on("show.bs.dropdown","#group-search-container",function(e){$("#group-search").next("div").find(".dropdown-menu").addClass("dropdown-width")}),$(document).on("click","#schedule-submit",function(){$("#error-filedkey-info").remove();var e=GetExportFileSettingInfo();if(null!==e){validateSubscriber();var t="",a={};switch(a.ScheduleName=$("#schedule-name").val(),a.ItemId=$(this).attr("data-report-id"),a.ExportType=$("input[name=exportFormats]:checked","#export-format-container").val().toString(),"Create"===actionType?(successMessage=window.Server.App.LocalizationContent.DashboardScheduleSuccess,t=addScheduleUrl):(successMessage=window.Server.App.LocalizationContent.ScheduleUpdateSuccess,a.ScheduleId=$(this).attr("data-schedule-id"),a.FailureOccurrence=scheduleRecurrenceInfo.FailureOccurrence,t=updateScheduleUrl),$("#recurrence-type").val().toString().toLowerCase()){case"daily":$("#daily-every-x-days").prop("checked")?(a.RecurrenceType="Daily",a.RecurrenceInterval=$("#every-x-days").val(),1===a.RecurrenceInterval?ScheduleDetail=window.Server.App.LocalizationContent.OccursEveryDay:ScheduleDetail=window.Server.App.LocalizationContent.OccursEvery+" "+a.RecurrenceInterval.toString()+" "+window.Server.App.LocalizationContent.Days):(a.RecurrenceType="DailyWeekDay",ScheduleDetail=window.Server.App.LocalizationContent.OccursEveryWeek);break;case"weekly":a.RecurrenceType="Weekly",a.RecurrenceInterval=$("#every-x-weeks").val(),a.Sunday=$("#sun").prop("checked"),a.Monday=$("#mon").prop("checked"),a.Tuesday=$("#tues").prop("checked"),a.Wednesday=$("#wed").prop("checked"),a.Thursday=$("#thu").prop("checked"),a.Friday=$("#fri").prop("checked"),a.Saturday=$("#sat").prop("checked");for(var s="",n=$(".daygroup:checked"),r=0;r<n.length;r++)s=1===n.length||0===r?$(n[r]).parent().text().trim():r>0&&r!==n.length-1?s+", "+$(n[r]).parent().text().trim():s+" "+window.Server.App.LocalizationContent.And+" "+$(n[r]).parent().text().trim();1===a.RecurrenceInterval?ScheduleDetail="Occurs every "+s:ScheduleDetail=window.Server.App.LocalizationContent.OccursEvery+" "+a.RecurrenceInterval.toString()+" "+window.Server.App.LocalizationContent.WeeksOn+" "+s;break;case"monthly":$("#monthly").prop("checked")?(a.RecurrenceType="Monthly",a.DaysOfMonth=$("#monthly-date").val(),a.RecurrenceInterval=$("#monthly-every-x-months").val(),ScheduleDetail=window.Server.App.LocalizationContent.OccursDay+" "+a.DaysOfMonth.toString()+" "+window.Server.App.LocalizationContent.Every+" "+a.RecurrenceInterval.toString()+" "+window.Server.App.LocalizationContent.Month):(a.RecurrenceType="MonthlyDOW",a.WeekOfMonth=$("#monthly-dow-week").find("option:selected").val(),a.DayOfWeek=$("#monthly-dow-day").find("option:selected").val(),a.RecurrenceInterval=$("#monthly-dow-every-x-months").val(),ScheduleDetail=window.Server.App.LocalizationContent.Occurs+" "+a.WeekOfMonth.toString()+" "+$("#monthly-dow-day").find("option:selected").val(),window.Server.App.LocalizationContent.Every,a.RecurrenceInterval.toString(),window.Server.App.LocalizationContent.Month);break;case"yearly":a.RecurrenceInterval=$("#every-x-years").val(),$("#yearly").prop("checked")?(a.RecurrenceType="Yearly",a.DaysOfMonth=$("#yearly-day").val(),a.MonthOfYear=$("#yearly-month").find("option:selected").val(),1===a.RecurrenceInterval?ScheduleDetail=window.Server.App.LocalizationContent.OccursEvery+" "+a.MonthOfYear.toString()+" "+a.DaysOfMonth.toString():ScheduleDetail=window.Server.App.LocalizationContent.OccursEvery+" "+a.RecurrenceInterval.toString()+" "+window.Server.App.LocalizationContent.Year+" "+a.MonthOfYear.toString()+" "+a.DaysOfMonth.toString()):(a.RecurrenceType="YearlyDOW",a.WeekOfMonth=$("#yearly-dow-week").find("option:selected").val(),a.DayOfWeek=$("#yearly-dow-day").find("option:selected").val(),a.MonthOfYear=$("#yearly-dow-month").find("option:selected").val(),1===a.RecurrenceInterval?ScheduleDetail=window.Server.App.LocalizationContent.Occurs+" "+a.WeekOfMonth.toString()+" "+$("#yearly-dow-day option:selected").val()+" "+window.Server.App.LocalizationContent.Of+" "+a.MonthOfYear.toString():ScheduleDetail=window.Server.App.LocalizationContent.OccursEvery+" "+a.RecurrenceInterval.toString()+" "+window.Server.App.LocalizationContent.Year+" "+a.WeekOfMonth.toString()+" "+$("#yearly-dow-day option:selected").text()+" "+window.Server.App.LocalizationContent.Of+" "+a.MonthOfYear.toString());break;case"hourly":a.RecurrenceType="Hourly",a.Frequency=$(".time-width").val(),a.RecurrenceInterval=$("#every-x-hours-value").val();var o=a.Frequency.split(":"),i=(o[0],o[1],"");parseInt(o[0])>0&&(i+=o[0]+" "+window.Server.App.LocalizationContent.Hours+" "),parseInt(o[1])>0&&(i+=o[1]+" "+window.Server.App.LocalizationContent.Minutes),ScheduleDetail=window.Server.App.LocalizationContent.OccursEvery+i}switch(a.IsEnabled=$("#enable-schedule").prop("checked"),a.FailureNotificationToOwner=!isSelfHosted||$("#enable-notification-to-owner").prop("checked"),a.FailureNotificationToRecipient=!isSelfHosted||$("#enable-notification-to-recipient").prop("checked"),a.IsNoDataEnabled=$("#nodata-disable").prop("checked"),a.IsParameterEnabled=$("#enable-parameter").prop("checked"),a.StartDate=$("#start-date").val(),void 0!==$("input[name=end-type]:checked","#schedule-end-type").val()?$("input[name=end-type]:checked","#schedule-end-type").val().toString():""){case"never":a.ScheduleEndType="NoEnd";break;case"endafter":a.ScheduleEndType="EndAfter",a.RecurrenceFactor=$("#occurence-count").val();break;case"endBy":a.ScheduleEndType="EndBy",a.EndDate=$("#end-date").val()}var l=$(".selected-recipients").children(),c=Array(),d=Array(),p=Array(),u=0,h=0,v=0;for(r=0;r<l.length;r++)"userSearch"===l[r].getAttribute("data-searchtype")&&-1!==u&&(c[u]=l[r].id,u++),"groupSearch"===l[r].getAttribute("data-searchtype")&&-1!==h&&(d[h]=l[r].id,h++),"externalRecipient"===l[r].getAttribute("data-searchtype")&&-1!==v&&(p[v]=l[r].id,v++);var m=null;null!=$("#reply-to-email").val()&&""!=$("#reply-to-email").val()&&(m=$("#reply-to-email").val());var f=window.reportParameterType,y=[];if($("#enable-parameter").prop("checked")){y=reportparameterObj;for(var S=0;S<reportparameterObj.length;S++){var g=window.parameterObj[S],w=!isEmptyOrWhitespace($("#"+parameterObj[S].Name).val());if(y[S].UseDefault=$("#"+parameterObj[S].Name+"-use-default").is(":checked"),isAdmin||itemPermission||1!=y[S].Hidden){if(w&&!1===$("#"+parameterObj[S].Name+"-use-default").is(":checked")){if(null===y[S].DefaultValue){b={Values:[]};y[S].DefaultValue=b}y[S].DataType===f.DateTime?y[S].DefaultValue.Values=$("#"+parameterObj[S].Name).val().split('/("[^"]*")|[^,]+/g'):"object"!=typeof $("#"+parameterObj[S].Name).val()?y[S].DefaultValue.Values=$("#"+parameterObj[S].Name).val().split(","):y[S].DefaultValue.Values=$("#"+parameterObj[S].Name).val()}else if(y[S].DataType===f.Boolean){if(null===y[S].DefaultValue&&y[S].Nullable){b={Values:["null"]};y[S].DefaultValue=b}if(null===defaultValue[S].DefaultValue&&defaultValue[S].Nullable&&(defaultValue[S].DefaultValue=["null"]),null===y[S].DefaultValue&&!y[S].Nullable){b={Values:["false"]};y[S].DefaultValue=b}null!==defaultValue[S].DefaultValue||defaultValue[S].Nullable||(defaultValue[S].DefaultValue=["false"]),$("#"+parameterObj[S].Name+"-use-default").is(":checked")?y[S].DefaultValue.Values=defaultValue[S].DefaultValue.Values.length>0?[defaultValue[S].DefaultValue.Values[0]]:["false"]:$("#true-"+g.Name).is(":checked")?($("#true-"+g.Name).ejRadioButton({size:"medium",checked:!0}),$("#true-"+g.Name).val("true"),$("#false-"+g.Name).val("false"),y[S].DefaultValue.Values[0]="true"):$("#false-"+g.Name).is(":checked")&&($("#false-"+g.Name).ejRadioButton({size:"medium",checked:!0}),$("#false-"+g.Name).val("true"),$("#true-"+g.Name).val("false"),y[S].DefaultValue.Values[0]="false")}else if(w&&!0===$("#"+parameterObj[S].Name+"-use-default").is(":checked")){if(null===y[S].DefaultValue){b={Values:[]};y[S].DefaultValue=b}null===defaultValue[S].DefaultValue&&(defaultValue[S].DefaultValue=[]),defaultValue[S].MultiValue?y[S].DefaultValue.Values=defaultValue[S].DefaultValue.Values:y[S].DefaultValue.Values=defaultValue[S].DefaultValue.Values.length>0?[defaultValue[S].DefaultValue.Values[0]]:defaultValue[S].DefaultValue.Values}}else{if(null===y[S].DefaultValue){var b={Values:[]};y[S].DefaultValue=b}null===defaultValue[S].DefaultValue&&(defaultValue[S].DefaultValue=[]),defaultValue[S].MultiValue?y[S].DefaultValue.Values=defaultValue[S].DefaultValue.Values:y[S].DefaultValue.Values=defaultValue[S].DefaultValue.Values.length>0?[defaultValue[S].DefaultValue.Values[0]]:defaultValue[S].DefaultValue.Values}}}if(isSelfHosted){if($("#save-as-file").is(":checked")&&$("#enable-send-mail").is(":checked")&&!$("#ftp-location-export").is(":checked")&&!$("#s3bucket-location-export").is(":checked")&&"none"===$("#local-export-div").css("display"))return void $("#checkbox-validation").css("visibility","visible").css({color:"#a94442","font-size":"12px"});$("#save-as-file").is(":checked")&&$("#enable-send-mail").is(":checked")&&$("#ftp-location-export").is(":checked")&&$("#s3bucket-location-export").is(":checked")||$("#save-as-file").is(":checked")||$("#enable-send-mail").is(":checked")||$("#ftp-location-export").is(":checked")||$("#s3bucket-location-export").is(":checked"),$("#checkbox-validation").css("visibility","hidden")}else{if(!1===($("#enable-send-mail").is(":checked")||$("#ftp-location-export").is(":checked")||$("#s3bucket-location-export").is(":checked")))return void $("#checkbox-validation").css("visibility","visible").css({color:"#a94442","font-size":"12px"});$("#enable-send-mail").is(":checked")&&$("#ftp-location-export").is(":checked")&&$("#s3bucket-location-export").is(":checked")||$("#enable-send-mail").is(":checked")||$("#ftp-location-export").is(":checked")||$("#s3bucket-location-export").is(":checked"),$("#checkbox-validation").css("visibility","hidden")}a.IsSaveAsFile=!1,a.IsSendAsMail=!1,1==isEmailcontentChanged&&(a.EmailContent=cursorPos.value()),0==isEmailcontentChanged&&""!=emailContent&&null!=emailContent&&(a.EmailContent=cursorPos.value()),(1==isSubjectcontentChanged||0==isSubjectcontentChanged&&""!=Subject&&null!=Subject)&&(a.Subject=$("#sub_email-text-box").val());if($("#save-as-file").is(":checked")&&$("#saveas-location-export").is(":checked")){if(""===$("#export-path").val())return $(".directory-check").css("display","block"),void $(".directory-check").html(window.Server.App.LocalizationContent.ScheduleReportPath).css({color:"#a94442","font-size":"12px"});if($("#export-path").val().indexOf(":")>0)return $(".directory-check").css("display","block"),void $(".directory-check").html(window.Server.App.LocalizationContent.pathNotExist).css({color:"#a94442","font-size":"12px"});if($(".directory-check").css("display","none"),$(".directory-check").html(""),$(".directory-check").hasClass("directory-exist"))return $(".directory-check").css("display","block"),void $(".directory-check").html(window.Server.App.LocalizationContent.pathNotExist).css({color:"#a94442","font-size":"12px"});if(a.ExportPath=$("#export-path").val(),!$.isNumeric(parseInt($("#max-report-count").val())))return void $("#report-count-validation").css("visibility","visible").css({color:"#a94442","font-size":"12px"});if(a.ReportCount=parseInt($("#max-report-count").val()),$("#report-count-validation").css("visibility","hidden"),a.IsSaveAsFile=!0,a.IsOverwrite=$("#overwrite-file").prop("checked"),$("#notify-users").is(":checked")){if(!l.length)return void $("#selected-users-validation").css("visibility","visible");a.IsNotifySaveAs=!0}}if($("#enable-send-mail").is(":checked")){if(!l.length)return void $("#selected-users-validation").css("visibility","visible");a.IsSendAsMail=!0}else if(!$("#enable-send-mail").is(":checked")&&!$("#save-as-file").is(":checked")){if(!l.length)return void $("#selected-users-validation").css("visibility","visible");a.IsSendAsMail=!1}if(validateReplyToEmail())if(!isAzureApplication||l.length){if(a.ExportFileName=$("#export-filename").val(),!($("#enable-send-mail").is(":checked")||$("#save-as-file").is(":checked")||$("#ftp-location-export").is(":checked")||$("#s3bucket-location-export").is(":checked"))){if(!l.length)return void $("#selected-users-validation").css("visibility","visible");a.IsSendAsMail=!1,a.IsSaveAsFile=!1}if($("#s3bucket-location-export").prop("checked")){var k=$("#s3-access-key").val(),C=$("#s3-bucket-name").val(),x=$("#s3-secretkey").val(),A=$("#s3-region").val();a.IsS3bucketEnabled=$("#s3bucket-location-export").prop("checked"),a.S3BucketName=C,a.S3Accesskey=k,a.S3SecretKey=x,a.S3Region=A,a.IsSaveAsFile=!0,S3BucketCredentialsValidation(),""!=k&&""!=C&&""!=x&&""!=A&&$.ajax({type:"POST",url:validateS3BucketCredentialsUrl,data:{bucketName:C,accesskey:k,secretKey:x,region:A},beforeSend:function(e){parent.$("#popup-container_wrapper").ejWaitingPopup("show"),parent.$("#editpopup-container_wrapper").ejWaitingPopup("show"),e.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())},success:function(s){var n=null!=s.ErrorMessage?s.ErrorMessage:"";parent.$("#popup-container_wrapper").ejWaitingPopup("hide"),parent.$("#editpopup-container_wrapper").ejWaitingPopup("hide"),s.IsS3CredentialsValid?$.ajax({type:"POST",url:t,data:{scheduleList:JSON.stringify({ScheduleItem:a,UserList:c,GroupList:d,ExternalRecipientList:p,ReplytoEmail:m,ParameterList:y}),scheduleExportFileSettingsData:JSON.stringify({ExportFileSetting:e})},beforeSend:function(e){parent.$("#popup-container_wrapper").ejWaitingPopup("show"),e.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())},success:function(e){switch(void 0!==$("input[name=end-type]:checked","#schedule-end-type").val()?$("input[name=end-type]:checked","#schedule-end-type").val().toString():""){case"never":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+e.NextSchedule;break;case"endafter":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+e.NextSchedule+" "+window.Server.App.LocalizationContent.EndsAfter+" "+a.RecurrenceFactor+" "+window.Server.App.LocalizationContent.Occurrence;break;case"endBy":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+e.NextSchedule+" "+window.Server.App.LocalizationContent.Until+" "+e.EndDate.toString()}parent.$("#popup-container_wrapper").ejWaitingPopup("hide");var t=$(".schedule-popup-title").text();closePopupContainer();var s=successMessage+ScheduleDetail,n=s.length>140?"success-message-large":"success-message-small";parent.messageBox("su-calendar-1",t,s,"success",function(){if(parent.onCloseMessageBox(),"function"==typeof parent.refreshScheduleGrid&&parent.refreshScheduleGrid(),parent.$("#on-board-schedule-dashboard").length>0&&!parent.$("#on-board-share-dashboard").hasClass("journey-done")){parent.$("#on-board-schedule-dashboard").addClass("journey-done").removeAttr("id");var e=parseInt(parent.$(".progress-bar-success").attr("data-progress-percentage"))+parseInt(parent.$(".progress-bar-success").attr("data-increment"));parent.$(".progress-bar-success").css("width",e+"%").attr("data-progress-percentage",e),parent.$(".progress-bar-percentage").text(e+"%")}},void 0,void 0,void 0,void 0,n)}}):$("#s3-bucket-validation").html(n).css("display","block").css({color:"#a94442","font-size":"12px"})}})}else if($("#ftp-location-export").prop("checked")){var D=$("#ftp-host-name").val(),V=$("#ftp-user-name").val(),L=$("#ftp-password").val();a.IsFTPExportOptionEnabled=$("#ftp-location-export").prop("checked"),a.FtpURL=D,a.FtpUsername=V,a.FtpPassword=L,a.IsSaveAsFile=!0,FTPCredentialsValidation(),""!=D&&""!=V&&""!=L&&$.ajax({type:"POST",url:validateFTPCredentialsUrl,data:{hostName:D,username:V,password:L},beforeSend:function(e){parent.$("#popup-container_wrapper").ejWaitingPopup("show"),parent.$("#editpopup-container_wrapper").ejWaitingPopup("show"),e.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())},success:function(s){var n=null!=s.ErrorMessage?s.ErrorMessage:"";parent.$("#popup-container_wrapper").ejWaitingPopup("hide"),parent.$("#editpopup-container_wrapper").ejWaitingPopup("hide"),s.IsFtpCredentialsAreValid?$.ajax({type:"POST",url:t,data:{scheduleList:JSON.stringify({ScheduleItem:a,UserList:c,GroupList:d,ExternalRecipientList:p,ReplytoEmail:m,ParameterList:y}),scheduleExportFileSettingsData:JSON.stringify({ExportFileSetting:e})},beforeSend:function(e){parent.$("#popup-container_wrapper").ejWaitingPopup("show"),e.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())},success:function(e){switch(void 0!==$("input[name=end-type]:checked","#schedule-end-type").val()?$("input[name=end-type]:checked","#schedule-end-type").val().toString():""){case"never":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+e.NextSchedule;break;case"endafter":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+e.NextSchedule+" "+window.Server.App.LocalizationContent.EndsAfter+" "+a.RecurrenceFactor+" "+window.Server.App.LocalizationContent.Occurrence;break;case"endBy":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+e.NextSchedule+" "+window.Server.App.LocalizationContent.Until+" "+e.EndDate.toString()}parent.$("#popup-container_wrapper").ejWaitingPopup("hide"),parent.$("#editpopup-container_wrapper").ejWaitingPopup("hide");var t=$(".schedule-popup-title").text();closePopupContainer();var s=successMessage+ScheduleDetail,n=s.length>140?"success-message-large":"success-message-small";parent.messageBox("su-calendar-1",t,s,"success",function(){if(parent.onCloseMessageBox(),"function"==typeof parent.refreshScheduleGrid&&parent.refreshScheduleGrid(),parent.$("#on-board-schedule-dashboard").length>0&&!parent.$("#on-board-share-dashboard").hasClass("journey-done")){parent.$("#on-board-schedule-dashboard").addClass("journey-done").removeAttr("id");var e=parseInt(parent.$(".progress-bar-success").attr("data-progress-percentage"))+parseInt(parent.$(".progress-bar-success").attr("data-increment"));parent.$(".progress-bar-success").css("width",e+"%").attr("data-progress-percentage",e),parent.$(".progress-bar-percentage").text(e+"%")}},void 0,void 0,void 0,void 0,n)}}):$("#ftp-validation").html(n).css("display","block").css({color:"#a94442","font-size":"12px"})}})}else $.ajax({type:"POST",url:t,data:{scheduleList:JSON.stringify({ScheduleItem:a,UserList:c,GroupList:d,ExternalRecipientList:p,ReplytoEmail:m,ParameterList:y}),scheduleExportFileSettingsData:JSON.stringify({ExportFileSetting:e})},beforeSend:function(e){parent.$("#popup-container_wrapper").ejWaitingPopup("show"),e.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())},success:function(e){switch(void 0!==$("input[name=end-type]:checked","#schedule-end-type").val()?$("input[name=end-type]:checked","#schedule-end-type").val().toString():""){case"never":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+e.NextSchedule;break;case"endafter":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+e.NextSchedule+" "+window.Server.App.LocalizationContent.EndsAfter+" "+a.RecurrenceFactor+" "+window.Server.App.LocalizationContent.Occurrence;break;case"endBy":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+e.NextSchedule+" "+window.Server.App.LocalizationContent.Until+" "+e.EndDate.toString()}parent.$("#popup-container_wrapper").ejWaitingPopup("hide"),parent.$("#editpopup-container_wrapper").ejWaitingPopup("hide");var t=$(".schedule-popup-title").text();closePopupContainer();var s=successMessage+ScheduleDetail,n=s.length>140?"success-message-large":"success-message-small";parent.messageBox("su-calendar-1",t,s,"success",function(){if(parent.onCloseMessageBox(),"function"==typeof parent.refreshScheduleGrid&&parent.refreshScheduleGrid(),parent.$("#on-board-schedule-dashboard").length>0&&!parent.$("#on-board-share-dashboard").hasClass("journey-done")){parent.$("#on-board-schedule-dashboard").addClass("journey-done").removeAttr("id");var e=parseInt(parent.$(".progress-bar-success").attr("data-progress-percentage"))+parseInt(parent.$(".progress-bar-success").attr("data-increment"));parent.$(".progress-bar-success").css("width",e+"%").attr("data-progress-percentage",e),parent.$(".progress-bar-percentage").text(e+"%")}},void 0,void 0,void 0,void 0,n)}})}else $("#selected-users-validation").css("visibility","visible")}}),$(document).ready(function(){$("#save-as-file").is(":checked")?$(".save-as-file-type").css("display","block"):$(".save-as-file-type").css("display","none"),toggleReplyToBlock()}),$(document).on("focusout","#reply-to-email",function(){validateReplyToEmail()}),$(document).on("keyup change","#reply-to-email",function(){$("#reply-to-email").removeClass("inactive-box"),$("#reply-to-email-validation").empty()}),$(document).on("focusout","#ftp-host-name, #ftp-user-name, #ftp-password",function(){FTPCredentialsValidation()}),$(document).on("keyup","#ftp-host-name",function(){$("#ftp-host-name").closest("div").removeClass("has-error"),$("#ftp-hostname-validation").css("display","none")}),$(document).on("keyup","#ftp-user-name",function(){$("#ftp-user-name").closest("div").removeClass("has-error"),$("#ftp-username-validation").css("display","none")}),$(document).on("keyup","#ftp-password",function(){$("#ftp-password").closest("div").removeClass("has-error"),$("#ftp-password-validation").css("display","none")}),$(document).on("click","#ftp-location-export",function(){$("#ftp-location-export").prop("checked")?$("#ftp-host-name, #ftp-user-name, #ftp-password").attr("disabled",!1):($("#ftp-host-name, #ftp-user-name, #ftp-password").attr("disabled",!0),$("#ftp-host-name, #ftp-user-name, #ftp-password").closest("div").removeClass("has-error"),$("#ftp-hostname-validation, #ftp-username-validation, #ftp-password-validation").css("display","none"))}),$(document).on("mousedown",".show-hide-password",function(){$(this).siblings("input").is(":password")?$(this).siblings("input").attr("type","text"):$(this).siblings("input").attr("type","password")}),$(document).on("mouseup",".show-hide-password",function(){$(this).siblings("input").is(":password")?$(this).siblings("input").attr("type","text"):$(this).siblings("input").attr("type","password")}),$(document).on("mouseleave",".show-hide-password",function(){$(this).siblings("input").attr("type","password")}),$(document).on("click","#s3bucket-location-export",function(){$("#ftp-location-export").prop("checked")?$("#ftp-host-name, #ftp-user-name, #ftp-password").attr("disabled",!1):($("#s3-bucket-name, #s3-secretkey, #s3-access-key, #s3-region").attr("disabled",!0),$("#s3-bucket-name, #s3-secretkey, #s3-access-key, #s3-region").closest("div").removeClass("has-error"),$("#s3-bucketname-validation, #s3-secretkey-validation, #s3-accesskey-validation, #s3-region-validation").css("display","none")),$("#s3-region").selectpicker("destroy"),$("#s3-region").selectpicker()}),$(document).on("click","#s3bucket-location-export",function(){$("#s3bucket-location-export").prop("checked")?$("#s3-bucket-name, #s3-secretkey, #s3-access-key, #s3-region").attr("disabled",!1):($("#s3-bucket-name, #s3-secretkey, #s3-access-key, #s3-region").attr("disabled",!0),$("#s3-bucket-name, #s3-secretkey, #s3-access-key, #s3-region").closest("div").removeClass("has-error"),$("#s3-bucketname-validation, #s3-secretkey-validation, #s3-accesskey-validation, #s3-region-validation").css("display","none")),$("#s3-region").selectpicker("destroy"),$("#s3-region").selectpicker()}),$.ajaxSetup({beforeSend:function(e){setXSRFRequestHeader(e)}});
