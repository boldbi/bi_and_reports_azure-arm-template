/*!
*  filename: schedulerrecipients.min.js
*  version : unknown version
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
function getAllStaticData(){window.userList===undefined&&$.ajax({type:"POST",url:getActiveandInactiveUserUrl,data:{},async:!1,success:function(n){window.userList=n.data.users;window.groupList=n.data.groups}});$("#user-search").append(window.userList);$("#group-search").append(window.groupList);$("#pdf-export").prop("checked",!0);$(".selectpicker").selectpicker("refresh");$("#schedule-submit").attr("data-report-id",createdItemId);$("#schedule-submit").attr("data-item-id",createdItemId);$("#user-search-container .bs-deselect-all").after("<div class='bs-select-all-custom'><span>"+window.Server.App.LocalizationContent.Select+"<\/span><span class='bs-select-custom-tick glyphicon glyphicon-ok' ><\/span><\/div>");$("#group-search-container .bs-deselect-all").after("<div class='bs-select-all-custom'><span>"+window.Server.App.LocalizationContent.Select+"<\/span><span class='bs-select-custom-tick glyphicon glyphicon-ok' ><\/span><\/div>")}function validateExternalRecipient(){$(document).on("keypress","#external-email",function(n){n.which===13&&(n.preventDefault(),$("#external-submit").click())});$(document).on("click","#external-submit",function(){for(var e=$("#external-email").val().toLowerCase(),n=e.split(","),u=[],r,i,f,t=0;t<n.length;t++)u.indexOf(n[t])===-1&&n[t]!==""&&u.push(n[t]);for(n=u,r=$(".selected-recipients").children(),i=0;i<n.length;i++)if(IsEmail(n[i])){for(f=$("<div>").attr("id",n[i]).attr("data-searchtype","externalRecipient").addClass("SelectedShareItems"),f.html("<div class='InstantSearch'><span class='details' title='"+n[i]+"'>"+n[i]+"<\/span><div style='width:auto' class='instant-cancel'><span class='su su-close i-selected-cancel'/><\/div><\/div>"),t=0;t<r.length;t++)if(r[t].getAttribute("data-searchtype")==="externalRecipient"&&n[i]===r[t].id){$("#external-email").addClass("inactive-box");$("#external-submit").addClass("inactive-icon");$("#external-email-validation").html("<span class='validate-fail'>"+window.Server.App.LocalizationContent.IsMailExist+"<\/span>");return}$("#selected-users").append(f);$("#external-email").val("");$("#selected-users-validation").css("visibility","hidden");selectedItemsCount()}else n[i]!==""?($("#external-email").addClass("inactive-box"),$("#external-submit").addClass("inactive-icon"),$("#external-email-validation").html("<span class='validate-fail'>"+window.Server.App.LocalizationContent.IsValidEmail+"<\/span>")):($("#external-email").removeClass("inactive-box"),$("#external-submit").removeClass("inactive-icon"),$("#external-email-validation").html())});$(document).on("keyup","#external-email",function(n){n.keyCode!==13&&($("#external-email").removeClass("inactive-box"),$("#external-submit").removeClass("inactive-icon"),$("#external-email-validation").html(""))})}function selectedItemsCount(){$("#selected-users-info").html("<span class='pull-left'>"+$(".SelectedShareItems[data-searchtype='userSearch']").length+" "+window.Server.App.LocalizationContent.Users+" "+$(".SelectedShareItems[data-searchtype='groupSearch']").length+" "+window.Server.App.LocalizationContent.Groups+" "+$(".SelectedShareItems[data-searchtype='externalRecipient']").length+" "+window.Server.App.LocalizationContent.ExternalRecipients+"<span>").css({"padding-top":"10px","padding-left":"15px","margin-top":"0"})}function validateSubscriber(){if(!$("#selected-users").children().length>0)return $("#selectedRecipientErrorContainer").css("display","block"),$("#selectedRecipientValidator").html(window.Server.App.LocalizationContent.AtleastOneRecipient),!1;$("#selectedRecipientErrorContainer").css("display","none")}function FTPCredentialsValidation(){$("#ftp-host-name").val()==""&&($("#ftp-host-name").closest("div").addClass("has-error"),$("#ftp-validation").css("display","none"),$("#ftp-hostname-validation").html(window.Server.App.LocalizationContent.HostNamevalidator).css("display","block").css({color:"#a94442","font-size":"12px"}));$("#ftp-user-name").val()==""&&($("#ftp-user-name").closest("div").addClass("has-error"),$("#ftp-validation").css("display","none"),$("#ftp-username-validation").html(window.Server.App.LocalizationContent.UserNameValidator).css("display","block").css({color:"#a94442","font-size":"12px"}));$("#ftp-password").val()==""&&($("#ftp-password").closest("div").addClass("has-error"),$("#ftp-validation").css("display","none"),$("#ftp-password-validation").html(window.Server.App.LocalizationContent.EnterPassword).css("display","block").css({color:"#a94442","font-size":"12px"}));return}function S3BucketCredentialsValidation(){$("#s3-access-key").val()==""&&($("#s3-access-key").closest("div").addClass("has-error"),$("#s3-bucket-validation").css("display","none"),$("#s3-accesskey-validation").html(window.Server.App.LocalizationContent.S3AccessKeyValidator).css("display","block").css({color:"#a94442","font-size":"12px"}));$("#s3-bucket-name").val()==""&&($("#s3-bucket-name").closest("div").addClass("has-error"),$("#s3-bucket-validation").css("display","none"),$("#s3-bucketname-validation").html(window.Server.App.LocalizationContent.S3BucketNameValidator).css("display","block").css({color:"#a94442","font-size":"12px"}));$("#s3-region").val()==""&&($("#s3-region").closest("div").addClass("has-error"),$("#s3-bucket-validation").css("display","none"),$("#s3-region-validation").html(window.Server.App.LocalizationContent.S3RegionValidator).css("display","block").css({color:"#a94442","font-size":"12px"}));$("#s3-secretkey").val()==""&&($("#s3-secretkey").closest("div").addClass("has-error"),$("#s3-bucket-validation").css("display","none"),$("#s3-secretkey-validation").html(window.Server.App.LocalizationContent.S3SecretKeyValidator).css("display","block").css({color:"#a94442","font-size":"12px"}));return}function extractXSRFTokenFromCookie(){var n=parent.document.cookie.split("; ").find(n=>n.startsWith("XSRF-TOKEN="));return n?n.split("=")[1]:null}function setXSRFRequestHeader(n){n.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())}function decodeHtmlAsString(n){var t=document.createElement("textarea");return t.innerHTML=n,t.value}function EscapeHtml(n){return n.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}$(document).on("click","#user-search-container .bs-select-all-custom",function(n){$("#user-search-container").addClass("value-changed");$("#user-search").data("selectpicker").selectAll();$(this).removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom");$($(this).children("span")[0]).text(window.Server.App.LocalizationContent.Clear);selectedItemsCount();n.stopPropagation()});$(document).on("click","#group-search-container .bs-select-all-custom",function(n){$("#group-search-container").addClass("value-changed");$("#group-search").data("selectpicker").selectAll();$(this).removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom");$($(this).children("span")[0]).text(window.Server.App.LocalizationContent.Clear);selectedItemsCount();n.stopPropagation()});$(document).on("click","#user-search-container .bs-deselect-all-custom",function(n){$("#user-search-container").addClass("value-changed");$("#user-search").data("selectpicker").deselectAll();$(this).removeClass("bs-deselect-all-custom").addClass("bs-select-all-custom");$($(this).children("span")[0]).text(window.Server.App.LocalizationContent.Select);$(".SelectedShareItems[data-searchtype='userSearch']").remove();selectedItemsCount();n.stopPropagation()});$(document).on("click","#group-search-container .bs-deselect-all-custom",function(n){$("#group-search-container").addClass("value-changed");$("#group-search").data("selectpicker").deselectAll();$(this).removeClass("bs-deselect-all-custom").addClass("bs-select-all-custom");$($(this).children("span")[0]).text(window.Server.App.LocalizationContent.Select);$(".SelectedShareItems[data-searchtype='groupSearch']").remove();selectedItemsCount();n.stopPropagation()});$(document).on("click","#user-search-container .bootstrap-select li a",function(n){var i,u,r,t;$("#user-search-container").addClass("value-changed");i=$("#user-search-container .bootstrap-select li.selected").length;u=$("#user-search-container .bootstrap-select li").length;i>0&&$("#selected-users-validation").css("visibility","hidden");i===u&&($($("#user-search-container div.bs-select-all-custom").children("span")[0]).text(window.Server.App.LocalizationContent.Clear),$("#user-search-container div.bs-select-all-custom").removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom"));$(this).parent().hasClass("selected")?(t=$("#user-search").find("option")[parseInt($(this).parent().attr("data-original-index"))],r=$("<div>").attr("id",$(t).val()).attr("data-searchtype","userSearch").addClass("SelectedShareItems"),r.html("<div class='InstantSearch'><span class='details' title='"+$(t).text()+"'>"+$(t).text()+"<\/span><div style='width:auto' class='instant-cancel'><span class='su su-close i-selected-cancel'/><\/div><\/div>"),$("#selected-users").append(r)):(t=$("#user-search").find("option")[parseInt($(this).parent().attr("data-original-index"))],$(".SelectedShareItems[id='"+$(t).val()+"']").remove(),$($("#user-search-container .bs-deselect-all-custom").children("span")[0]).text(window.Server.App.LocalizationContent.Select),$("#user-search-container .bs-deselect-all-custom").removeClass("bs-deselect-all-custom").addClass("bs-select-all-custom"));$(this).parent().addClass("active");selectedItemsCount();n.stopPropagation()});$(document).on("click","#group-search-container .bootstrap-select .dropdown-menu .selectpicker li a",function(n){var i,u,r,t;$("#group-search-container").addClass("value-changed");i=$("#group-search-container .bootstrap-select li.selected").length;u=$("#group-search-container .bootstrap-select li").length;i>0&&$("#selected-users-validation").css("visibility","hidden");i===u&&($($("#group-search-container div.bs-select-all-custom").children("span")[0]).text(window.Server.App.LocalizationContent.Clear),$("#group-search-container div.bs-select-all-custom").removeClass("bs-select-all-custom").addClass("bs-deselect-all-custom"));$(this).parent().hasClass("selected")?(t=$("#group-search").find("option")[parseInt($(this).parent().attr("data-original-index"))],r=$("<div>").attr("id",$(t).val()).attr("data-searchtype","groupSearch").addClass("SelectedShareItems"),r.html("<div class='InstantSearch'><span class='details' title='"+$(t).text()+"'>"+$(t).text()+"<\/span><div style='width:auto' class='instant-cancel'><span class='su su-close i-selected-cancel'/><\/div><\/div>"),$("#selected-users").append(r)):(t=$("#group-search").find("option")[parseInt($(this).parent().attr("data-original-index"))],$(".SelectedShareItems").filter("[data-searchtype='groupSearch']").filter("#"+$(t).val()).remove(),$($("#group-search-container .bs-deselect-all-custom").children("span")[0]).text(window.Server.App.LocalizationContent.Select),$("#group-search-container .bs-deselect-all-custom").removeClass("bs-deselect-all-custom").addClass("bs-select-all-custom"));$(this).parent().addClass("active");selectedItemsCount();n.stopPropagation()});$(document).on("click","#subscribers-panel .i-selected-cancel",function(){var n=$(this).parents(".SelectedShareItems").attr("id"),t=$(this).parents(".SelectedShareItems").attr("data-searchtype");t==="userSearch"?(currentElementIndex=$("#user-search").find("[value='"+n+"']").index(),$("#user-search-container .bootstrap-select li").filter("[data-original-index='"+currentElementIndex+"']").find("a").click()):t==="groupSearch"?(currentElementIndex=$("#group-search").find("[value='"+n+"']").index(),$("#group-search-container .bootstrap-select li").filter("[data-original-index='"+currentElementIndex+"']").find("a").click()):t==="externalRecipient"&&$(".SelectedShareItems[id='"+n+"']").remove();selectedItemsCount()});$(document).on("hide.bs.dropdown","#user-search-container",function(n){$("#user-search-container").hasClass("value-changed")&&($("#user-search-container").removeClass("value-changed"),n.stopPropagation())});$(document).on("hide.bs.dropdown","#group-search-container",function(n){$("#group-search-container").hasClass("value-changed")&&($("#group-search-container").removeClass("value-changed"),n.stopPropagation())});$(document).on("show.bs.dropdown","#user-search-container",function(){$("#user-search").next("div").find(".dropdown-menu").addClass("dropdown-width");for(var n=0;n<$("#user-search option").length;n++)$("#user-search option").eq(n).attr("data-show").toLowerCase()=="false"&&($("#user-search-container .dropdown-menu .inner li").eq(n).addClass("disabled user-disabled"),$("#user-search-container .dropdown-menu .inner li").eq(n).attr("data-toggle","tooltip").attr("data-placement","right").attr("data-original-title",window.Server.App.LocalizationContent.AutoGeneratedMail)),$('[data-toggle="tooltip"]').tooltip()});$(document).on("show.bs.dropdown","#group-search-container",function(){$("#group-search").next("div").find(".dropdown-menu").addClass("dropdown-width")});$(document).on("click","#schedule-submit",function(){var l,s,n,h,o,st,r,d,i,t,e,g,u,ht,ct,nt;if($("#error-filedkey-info").remove(),l=GetExportFileSettingInfo(),l!==null){validateSubscriber();s="";n={};n.ScheduleName=$("#schedule-name").val();n.ItemId=$(this).attr("data-report-id");n.ExportType=$("input[name=exportFormats]:checked","#export-format-container").val().toString();actionType==="Create"?(successMessage=window.Server.App.LocalizationContent.DashboardScheduleSuccess,s=addScheduleUrl):(successMessage=window.Server.App.LocalizationContent.ScheduleUpdateSuccess,n.ScheduleId=$(this).attr("data-schedule-id"),n.FailureOccurrence=scheduleRecurrenceInfo.FailureOccurrence,s=updateScheduleUrl);switch($("#recurrence-type").val().toString().toLowerCase()){case"daily":$("#daily-every-x-days").prop("checked")?(n.RecurrenceType="Daily",n.RecurrenceInterval=$("#every-x-days").val(),ScheduleDetail=n.RecurrenceInterval===1?window.Server.App.LocalizationContent.OccursEveryDay:window.Server.App.LocalizationContent.OccursEvery+" "+n.RecurrenceInterval.toString()+" "+window.Server.App.LocalizationContent.Days):(n.RecurrenceType="DailyWeekDay",ScheduleDetail=window.Server.App.LocalizationContent.OccursEveryWeek);break;case"weekly":for(n.RecurrenceType="Weekly",n.RecurrenceInterval=$("#every-x-weeks").val(),n.Sunday=$("#sun").prop("checked"),n.Monday=$("#mon").prop("checked"),n.Tuesday=$("#tues").prop("checked"),n.Wednesday=$("#wed").prop("checked"),n.Thursday=$("#thu").prop("checked"),n.Friday=$("#fri").prop("checked"),n.Saturday=$("#sat").prop("checked"),h="",o=$(".daygroup:checked"),r=0;r<o.length;r++)h=o.length===1||r===0?$(o[r]).parent().text().trim():r>0&&r!==o.length-1?h+", "+$(o[r]).parent().text().trim():h+" "+window.Server.App.LocalizationContent.And+" "+$(o[r]).parent().text().trim();ScheduleDetail=n.RecurrenceInterval===1?"Occurs every "+h:window.Server.App.LocalizationContent.OccursEvery+" "+n.RecurrenceInterval.toString()+" "+window.Server.App.LocalizationContent.WeeksOn+" "+h;break;case"monthly":$("#monthly").prop("checked")?(n.RecurrenceType="Monthly",n.DaysOfMonth=$("#monthly-date").val(),n.RecurrenceInterval=$("#monthly-every-x-months").val(),ScheduleDetail=window.Server.App.LocalizationContent.OccursDay+" "+n.DaysOfMonth.toString()+" "+window.Server.App.LocalizationContent.Every+" "+n.RecurrenceInterval.toString()+" "+window.Server.App.LocalizationContent.Month):(n.RecurrenceType="MonthlyDOW",n.WeekOfMonth=$("#monthly-dow-week").find("option:selected").val(),n.DayOfWeek=$("#monthly-dow-day").find("option:selected").val(),n.RecurrenceInterval=$("#monthly-dow-every-x-months").val(),ScheduleDetail=window.Server.App.LocalizationContent.Occurs+" "+n.WeekOfMonth.toString()+" "+$("#monthly-dow-day").find("option:selected").val(),0+window.Server.App.LocalizationContent.Every+" "+n.RecurrenceInterval.toString()+" "+window.Server.App.LocalizationContent.Month);break;case"yearly":n.RecurrenceInterval=$("#every-x-years").val();$("#yearly").prop("checked")?(n.RecurrenceType="Yearly",n.DaysOfMonth=$("#yearly-day").val(),n.MonthOfYear=$("#yearly-month").find("option:selected").val(),ScheduleDetail=n.RecurrenceInterval===1?window.Server.App.LocalizationContent.OccursEvery+" "+n.MonthOfYear.toString()+" "+n.DaysOfMonth.toString():window.Server.App.LocalizationContent.OccursEvery+" "+n.RecurrenceInterval.toString()+" "+window.Server.App.LocalizationContent.Year+" "+n.MonthOfYear.toString()+" "+n.DaysOfMonth.toString()):(n.RecurrenceType="YearlyDOW",n.WeekOfMonth=$("#yearly-dow-week").find("option:selected").val(),n.DayOfWeek=$("#yearly-dow-day").find("option:selected").val(),n.MonthOfYear=$("#yearly-dow-month").find("option:selected").val(),ScheduleDetail=n.RecurrenceInterval===1?window.Server.App.LocalizationContent.Occurs+" "+n.WeekOfMonth.toString()+" "+$("#yearly-dow-day option:selected").val()+" "+window.Server.App.LocalizationContent.Of+" "+n.MonthOfYear.toString():window.Server.App.LocalizationContent.OccursEvery+" "+n.RecurrenceInterval.toString()+" "+window.Server.App.LocalizationContent.Year+" "+n.WeekOfMonth.toString()+" "+$("#yearly-dow-day option:selected").text()+" "+window.Server.App.LocalizationContent.Of+" "+n.MonthOfYear.toString());break;case"hourly":n.RecurrenceType="Hourly";n.Frequency=$(".time-width").val();n.RecurrenceInterval=$("#every-x-hours-value").val();var c=n.Frequency.split(":"),lt=c[0]+c[1],p="";parseInt(c[0])>0&&(p+=c[0]+" "+window.Server.App.LocalizationContent.Hours+" ");parseInt(c[1])>0&&(p+=c[1]+" "+window.Server.App.LocalizationContent.Minutes);ScheduleDetail=window.Server.App.LocalizationContent.OccursEvery+p}n.IsEnabled=$("#enable-schedule").prop("checked");n.FailureNotificationToOwner=isSelfHosted?$("#enable-notification-to-owner").prop("checked"):!0;n.FailureNotificationToRecipient=isSelfHosted?$("#enable-notification-to-recipient").prop("checked"):!0;n.IsNoDataEnabled=$("#nodata-disable").prop("checked");n.IsParameterEnabled=$("#enable-parameter").prop("checked");n.StartDate=$("#start-date").val();st=$("input[name=end-type]:checked","#schedule-end-type").val()!==undefined?$("input[name=end-type]:checked","#schedule-end-type").val().toString():"";switch(st){case"never":n.ScheduleEndType="NoEnd";break;case"endafter":n.ScheduleEndType="EndAfter";n.RecurrenceFactor=$("#occurence-count").val();break;case"endBy":n.ScheduleEndType="EndBy";n.EndDate=$("#end-date").val()}var f=$(".selected-recipients").children(),a=Array(),v=Array(),y=Array(),w=0,b=0,k=0;for(r=0;r<f.length;r++)f[r].getAttribute("data-searchtype")==="userSearch"&&w!==-1&&(a[w]=f[r].id,w++),f[r].getAttribute("data-searchtype")==="groupSearch"&&b!==-1&&(v[b]=f[r].id,b++),f[r].getAttribute("data-searchtype")==="externalRecipient"&&k!==-1&&(y[k]=f[r].id,k++);if(d=window.reportParameterType,i=[],$("#enable-parameter").prop("checked"))for(i=reportparameterObj,t=0;t<reportparameterObj.length;t++)e=window.parameterObj[t],g=!isEmptyOrWhitespace($("#"+parameterObj[t].Name).val()),i[t].UseDefault=$("#"+parameterObj[t].Name+"-use-default").is(":checked"),i[t].Hidden==!0?(i[t].DefaultValue===null&&(u={Values:[]},i[t].DefaultValue=u),reportparameterDefaultValue[t].DefaultValue===null&&(u={Values:[]},reportparameterDefaultValue[t].DefaultValue=u),i[t].DefaultValue.Values=reportparameterDefaultValue[t].DefaultValue.Values):g&&$("#"+parameterObj[t].Name+"-use-default").is(":checked")===!1?(i[t].DefaultValue===null&&(u={Values:[]},i[t].DefaultValue=u),i[t].DefaultValue.Values=i[t].DataType===d.DateTime?$("#"+parameterObj[t].Name).val().split('/("[^"]*")|[^,]+/g'):typeof $("#"+parameterObj[t].Name).val()!="object"?$("#"+parameterObj[t].Name).val().split(","):$("#"+parameterObj[t].Name).val()):i[t].DataType===d.Boolean?(i[t].DefaultValue===null&&i[t].Nullable&&(u={Values:["null"]},i[t].DefaultValue=u),reportparameterDefaultValue[t].DefaultValue===null&&reportparameterDefaultValue[t].Nullable&&(u={Values:["null"]},reportparameterDefaultValue[t].DefaultValue=u),i[t].DefaultValue!==null||i[t].Nullable||(u={Values:["false"]},i[t].DefaultValue=u),reportparameterDefaultValue[t].DefaultValue!==null||reportparameterDefaultValue[t].Nullable||(u={Values:["false"]},reportparameterDefaultValue[t].DefaultValue=u),$("#"+parameterObj[t].Name+"-use-default").is(":checked")?i[t].DefaultValue.Values=reportparameterDefaultValue[t].DefaultValue.Values:$("#true-"+e.Name).is(":checked")?($("#true-"+e.Name).ejRadioButton({size:"medium",checked:!0}),$("#true-"+e.Name).val("true"),$("#false-"+e.Name).val("false"),i[t].DefaultValue.Values[0]="true"):$("#false-"+e.Name).is(":checked")&&($("#false-"+e.Name).ejRadioButton({size:"medium",checked:!0}),$("#false-"+e.Name).val("true"),$("#true-"+e.Name).val("false"),i[t].DefaultValue.Values[0]="false")):g&&$("#"+parameterObj[t].Name+"-use-default").is(":checked")===!0&&(i[t].DefaultValue===null&&(u={Values:[]},i[t].DefaultValue=u),reportparameterDefaultValue[t].DefaultValue===null&&(u={Values:[]},reportparameterDefaultValue[t].DefaultValue=u),i[t].DefaultValue.Values=reportparameterDefaultValue[t].DefaultValue.Values);if(isSelfHosted){if(($("#save-as-file").is(":checked")||$("#enable-send-mail").is(":checked")||$("#ftp-location-export").is(":checked")||$("#s3bucket-location-export").is(":checked"))===!1){$("#checkbox-validation").css("visibility","visible").css({color:"#a94442","font-size":"12px"});return}$("#save-as-file").is(":checked")&&$("#enable-send-mail").is(":checked")&&$("#ftp-location-export").is(":checked")&&$("#s3bucket-location-export").is(":checked")?$("#checkbox-validation").css("visibility","hidden"):$("#save-as-file").is(":checked")||$("#enable-send-mail").is(":checked")||$("#ftp-location-export").is(":checked")||$("#s3bucket-location-export").is(":checked")?$("#checkbox-validation").css("visibility","hidden"):$("#checkbox-validation").css("visibility","hidden")}else{if(($("#enable-send-mail").is(":checked")||$("#ftp-location-export").is(":checked")||$("#s3bucket-location-export").is(":checked"))===!1){$("#checkbox-validation").css("visibility","visible").css({color:"#a94442","font-size":"12px"});return}$("#enable-send-mail").is(":checked")&&$("#ftp-location-export").is(":checked")&&$("#s3bucket-location-export").is(":checked")?$("#checkbox-validation").css("visibility","hidden"):$("#enable-send-mail").is(":checked")||$("#ftp-location-export").is(":checked")||$("#s3bucket-location-export").is(":checked")?$("#checkbox-validation").css("visibility","hidden"):$("#checkbox-validation").css("visibility","hidden")}if(n.IsSaveAsFile=!1,n.IsSendAsMail=!1,isEmailcontentChanged==1&&(n.EmailContent=cursorPos.value()),isEmailcontentChanged==0&&emailContent!=""&&emailContent!=null&&(n.EmailContent=cursorPos.value()),(isSubjectcontentChanged==1||isSubjectcontentChanged==0&&Subject!=""&&Subject!=null)&&(n.Subject=$("#sub_email-text-box").val()),ht=!1,$("#save-as-file").is(":checked")&&$("#saveas-location-export").is(":checked")){if($("#export-path").val()===""){$(".directory-check").css("display","block");$(".directory-check").html(window.Server.App.LocalizationContent.ScheduleReportPath).css({color:"#a94442","font-size":"12px"});return}if(ct=$("#export-path").val(),ct.indexOf(":")>0){$(".directory-check").css("display","block");$(".directory-check").html(window.Server.App.LocalizationContent.pathNotExist).css({color:"#a94442","font-size":"12px"});return}if($(".directory-check").css("display","none"),$(".directory-check").html(""),$(".directory-check").hasClass("directory-exist")){$(".directory-check").css("display","block");$(".directory-check").html(window.Server.App.LocalizationContent.pathNotExist).css({color:"#a94442","font-size":"12px"});return}if(n.ExportPath=$("#export-path").val(),$.isNumeric(parseInt($("#max-report-count").val())))n.ReportCount=parseInt($("#max-report-count").val()),$("#report-count-validation").css("visibility","hidden");else{$("#report-count-validation").css("visibility","visible").css({color:"#a94442","font-size":"12px"});return}if(n.IsSaveAsFile=!0,n.IsOverwrite=$("#overwrite-file").prop("checked"),ht=!0,$("#notify-users").is(":checked"))if(f.length)n.IsNotifySaveAs=!0,nt=!0;else{$("#selected-users-validation").css("visibility","visible");return}}if(nt=!1,$("#enable-send-mail").is(":checked"))if(f.length)n.IsSendAsMail=!0,nt=!0;else{$("#selected-users-validation").css("visibility","visible");return}if(isAzureApplication&&!f.length){$("#selected-users-validation").css("visibility","visible");return}if(n.ExportFileName=$("#export-filename").val(),$("#s3bucket-location-export").prop("checked")){var tt=$("#s3-access-key").val(),it=$("#s3-bucket-name").val(),rt=$("#s3-secretkey").val(),ut=$("#s3-region").val();n.IsS3bucketEnabled=$("#s3bucket-location-export").prop("checked");n.S3BucketName=it;n.S3Accesskey=tt;n.S3SecretKey=rt;n.S3Region=ut;S3BucketCredentialsValidation();tt!=""&&it!=""&&rt!=""&&ut!=""&&$.ajax({type:"POST",url:validateS3BucketCredentialsUrl,data:{bucketName:it,accesskey:tt,secretKey:rt,region:ut},beforeSend:function(n){parent.$("#popup-container_wrapper").ejWaitingPopup("show");parent.$("#editpopup-container_wrapper").ejWaitingPopup("show");n.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())},success:function(t){var r=t.ErrorMessage!=undefined?t.ErrorMessage:"";parent.$("#popup-container_wrapper").ejWaitingPopup("hide");parent.$("#editpopup-container_wrapper").ejWaitingPopup("hide");t.IsS3CredentialsValid?$.ajax({type:"POST",url:s,data:{scheduleList:JSON.stringify({ScheduleItem:n,UserList:a,GroupList:v,ExternalRecipientList:y,ParameterList:i}),scheduleExportFileSettingsData:JSON.stringify({ExportFileSetting:l})},beforeSend:function(n){parent.$("#popup-container_wrapper").ejWaitingPopup("show");n.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())},success:function(t){var f=$("input[name=end-type]:checked","#schedule-end-type").val()!==undefined?$("input[name=end-type]:checked","#schedule-end-type").val().toString():"",r,i,u;switch(f){case"never":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+t.NextSchedule;break;case"endafter":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+t.NextSchedule+" "+window.Server.App.LocalizationContent.EndsAfter+" "+n.RecurrenceFactor+" "+window.Server.App.LocalizationContent.Occurrence;break;case"endBy":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+t.NextSchedule+" "+window.Server.App.LocalizationContent.Until+" "+t.EndDate.toString()}parent.$("#popup-container_wrapper").ejWaitingPopup("hide");r=$(".schedule-popup-title").text();closePopupContainer();i=successMessage+ScheduleDetail;u=i.length>140?"success-message-large":"success-message-small";parent.messageBox("su-calendar-1",r,i,"success",function(){if(parent.onCloseMessageBox(),typeof parent.refreshScheduleGrid=="function"&&parent.refreshScheduleGrid(),parent.$("#on-board-schedule-dashboard").length>0&&!parent.$("#on-board-share-dashboard").hasClass("journey-done")){parent.$("#on-board-schedule-dashboard").addClass("journey-done").removeAttr("id");var n=parseInt(parent.$(".progress-bar-success").attr("data-progress-percentage"))+parseInt(parent.$(".progress-bar-success").attr("data-increment"));parent.$(".progress-bar-success").css("width",n+"%").attr("data-progress-percentage",n);parent.$(".progress-bar-percentage").text(n+"%")}},undefined,undefined,undefined,undefined,u)}}):$("#s3-bucket-validation").html(r).css("display","block").css({color:"#a94442","font-size":"12px"})}})}else if($("#ftp-location-export").prop("checked")){var ft=$("#ftp-host-name").val(),et=$("#ftp-user-name").val(),ot=$("#ftp-password").val();n.IsFTPExportOptionEnabled=$("#ftp-location-export").prop("checked");n.FtpURL=ft;n.FtpUsername=et;n.FtpPassword=ot;FTPCredentialsValidation();ft!=""&&et!=""&&ot!=""&&$.ajax({type:"POST",url:validateFTPCredentialsUrl,data:{hostName:ft,username:et,password:ot},beforeSend:function(n){parent.$("#popup-container_wrapper").ejWaitingPopup("show");parent.$("#editpopup-container_wrapper").ejWaitingPopup("show");n.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())},success:function(t){var r=t.ErrorMessage!=undefined?t.ErrorMessage:"";parent.$("#popup-container_wrapper").ejWaitingPopup("hide");parent.$("#editpopup-container_wrapper").ejWaitingPopup("hide");t.IsFtpCredentialsAreValid?$.ajax({type:"POST",url:s,data:{scheduleList:JSON.stringify({ScheduleItem:n,UserList:a,GroupList:v,ExternalRecipientList:y,ParameterList:i}),scheduleExportFileSettingsData:JSON.stringify({ExportFileSetting:l})},beforeSend:function(n){parent.$("#popup-container_wrapper").ejWaitingPopup("show");n.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())},success:function(t){var f=$("input[name=end-type]:checked","#schedule-end-type").val()!==undefined?$("input[name=end-type]:checked","#schedule-end-type").val().toString():"",r,i,u;switch(f){case"never":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+t.NextSchedule;break;case"endafter":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+t.NextSchedule+" "+window.Server.App.LocalizationContent.EndsAfter+" "+n.RecurrenceFactor+" "+window.Server.App.LocalizationContent.Occurrence;break;case"endBy":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+t.NextSchedule+" "+window.Server.App.LocalizationContent.Until+" "+t.EndDate.toString()}parent.$("#popup-container_wrapper").ejWaitingPopup("hide");parent.$("#editpopup-container_wrapper").ejWaitingPopup("hide");r=$(".schedule-popup-title").text();closePopupContainer();i=successMessage+ScheduleDetail;u=i.length>140?"success-message-large":"success-message-small";parent.messageBox("su-calendar-1",r,i,"success",function(){if(parent.onCloseMessageBox(),typeof parent.refreshScheduleGrid=="function"&&parent.refreshScheduleGrid(),parent.$("#on-board-schedule-dashboard").length>0&&!parent.$("#on-board-share-dashboard").hasClass("journey-done")){parent.$("#on-board-schedule-dashboard").addClass("journey-done").removeAttr("id");var n=parseInt(parent.$(".progress-bar-success").attr("data-progress-percentage"))+parseInt(parent.$(".progress-bar-success").attr("data-increment"));parent.$(".progress-bar-success").css("width",n+"%").attr("data-progress-percentage",n);parent.$(".progress-bar-percentage").text(n+"%")}},undefined,undefined,undefined,undefined,u)}}):$("#ftp-validation").html(r).css("display","block").css({color:"#a94442","font-size":"12px"})}})}else $("#save-as-file").is(":checked")||$("#enable-send-mail").is(":checked")||isAzureApplication||!isSelfHosted?$.ajax({type:"POST",url:s,data:{scheduleList:JSON.stringify({ScheduleItem:n,UserList:a,GroupList:v,ExternalRecipientList:y,ParameterList:i}),scheduleExportFileSettingsData:JSON.stringify({ExportFileSetting:l})},beforeSend:function(n){parent.$("#popup-container_wrapper").ejWaitingPopup("show");n.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())},success:function(t){var f=$("input[name=end-type]:checked","#schedule-end-type").val()!==undefined?$("input[name=end-type]:checked","#schedule-end-type").val().toString():"",r,i,u;switch(f){case"never":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+t.NextSchedule;break;case"endafter":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+t.NextSchedule+" "+window.Server.App.LocalizationContent.EndsAfter+" "+n.RecurrenceFactor+" "+window.Server.App.LocalizationContent.Occurrence;break;case"endBy":ScheduleDetail=ScheduleDetail+" "+window.Server.App.LocalizationContent.EffectiveFrom+" "+t.NextSchedule+" "+window.Server.App.LocalizationContent.Until+" "+t.EndDate.toString()}parent.$("#popup-container_wrapper").ejWaitingPopup("hide");parent.$("#editpopup-container_wrapper").ejWaitingPopup("hide");r=$(".schedule-popup-title").text();closePopupContainer();i=successMessage+ScheduleDetail;u=i.length>140?"success-message-large":"success-message-small";parent.messageBox("su-calendar-1",r,i,"success",function(){if(parent.onCloseMessageBox(),typeof parent.refreshScheduleGrid=="function"&&parent.refreshScheduleGrid(),parent.$("#on-board-schedule-dashboard").length>0&&!parent.$("#on-board-share-dashboard").hasClass("journey-done")){parent.$("#on-board-schedule-dashboard").addClass("journey-done").removeAttr("id");var n=parseInt(parent.$(".progress-bar-success").attr("data-progress-percentage"))+parseInt(parent.$(".progress-bar-success").attr("data-increment"));parent.$(".progress-bar-success").css("width",n+"%").attr("data-progress-percentage",n);parent.$(".progress-bar-percentage").text(n+"%")}},undefined,undefined,undefined,undefined,u)}}):$("#selected-users-validation").css("visibility","visible")}});$(document).ready(function(){$("#save-as-file").is(":checked")?$(".save-as-file-type").css("display","block"):$(".save-as-file-type").css("display","none")});$(document).on("focusout","#ftp-host-name, #ftp-user-name, #ftp-password",function(){FTPCredentialsValidation()});$(document).on("keyup","#ftp-host-name",function(){$("#ftp-host-name").closest("div").removeClass("has-error");$("#ftp-hostname-validation").css("display","none")});$(document).on("keyup","#ftp-user-name",function(){$("#ftp-user-name").closest("div").removeClass("has-error");$("#ftp-username-validation").css("display","none")});$(document).on("keyup","#ftp-password",function(){$("#ftp-password").closest("div").removeClass("has-error");$("#ftp-password-validation").css("display","none")});$(document).on("click","#ftp-location-export",function(){$("#ftp-location-export").prop("checked")?$("#ftp-host-name, #ftp-user-name, #ftp-password").attr("disabled",!1):($("#ftp-host-name, #ftp-user-name, #ftp-password").attr("disabled",!0),$("#ftp-host-name, #ftp-user-name, #ftp-password").closest("div").removeClass("has-error"),$("#ftp-hostname-validation, #ftp-username-validation, #ftp-password-validation").css("display","none"))});$(document).on("mousedown",".show-hide-password",function(){$(this).siblings("input").is(":password")?$(this).siblings("input").attr("type","text"):$(this).siblings("input").attr("type","password")});$(document).on("mouseup",".show-hide-password",function(){$(this).siblings("input").is(":password")?$(this).siblings("input").attr("type","text"):$(this).siblings("input").attr("type","password")});$(document).on("mouseleave",".show-hide-password",function(){$(this).siblings("input").attr("type","password")});$(document).on("click","#s3bucket-location-export",function(){$("#ftp-location-export").prop("checked")?$("#ftp-host-name, #ftp-user-name, #ftp-password").attr("disabled",!1):($("#s3-bucket-name, #s3-secretkey, #s3-access-key, #s3-region").attr("disabled",!0),$("#s3-bucket-name, #s3-secretkey, #s3-access-key, #s3-region").closest("div").removeClass("has-error"),$("#s3-bucketname-validation, #s3-secretkey-validation, #s3-accesskey-validation, #s3-region-validation").css("display","none"));$("#s3-region").selectpicker("refresh")});$(document).on("click","#s3bucket-location-export",function(){$("#s3bucket-location-export").prop("checked")?$("#s3-bucket-name, #s3-secretkey, #s3-access-key, #s3-region").attr("disabled",!1):($("#s3-bucket-name, #s3-secretkey, #s3-access-key, #s3-region").attr("disabled",!0),$("#s3-bucket-name, #s3-secretkey, #s3-access-key, #s3-region").closest("div").removeClass("has-error"),$("#s3-bucketname-validation, #s3-secretkey-validation, #s3-accesskey-validation, #s3-region-validation").css("display","none"));$("#s3-region").selectpicker("refresh")});$.ajaxSetup({beforeSend:function(n){setXSRFRequestHeader(n)}})